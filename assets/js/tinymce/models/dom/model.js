!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.ModelManager");const t=e=>t=>(e=>{const t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&(o=r=e,n=(l=String).prototype,n.isPrototypeOf(o)||(null===(s=r.constructor)||void 0===s?void 0:s.name)===l.name)?"string":t;var o,n;var r,l,s})(t)===e,o=e=>t=>typeof t===e,n=e=>t=>e===t,r=t("string"),l=t("object"),s=t("array"),a=n(null),i=o("boolean"),c=n(void 0),m=e=>!(e=>null==e)(e),d=o("function"),u=o("number"),p=()=>{},f=e=>()=>e,g=e=>e,h=(e,t)=>e===t;function b(e,...t){return(...o)=>{const n=t.concat(o);return e.apply(null,n)}}const w=e=>t=>!e(t),O=e=>e(),v=f(!1),y=f(!0);class Optional{constructor(e,t){this.tag=e,this.value=t}static some(e){return new Optional(!0,e)}static none(){return Optional.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?Optional.some(e(this.value)):Optional.none()}bind(e){return this.tag?e(this.value):Optional.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:Optional.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(null!=e?e:"Called getOrDie on None")}static from(e){return m(e)?Optional.some(e):Optional.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}Optional.singletonNone=new Optional(!1);const C=Array.prototype.slice,x=Array.prototype.indexOf,T=Array.prototype.push,S=(e,t)=>{return o=e,n=t,x.call(o,n)>-1;var o,n},R=(e,t)=>{for(let o=0,n=e.length;o<n;o++){if(t(e[o],o))return!0}return!1},D=(e,t)=>{const o=[];for(let n=0;n<e;n++)o.push(t(n));return o},k=(e,t)=>{const o=e.length,n=new Array(o);for(let r=0;r<o;r++){const o=e[r];n[r]=t(o,r)}return n},E=(e,t)=>{for(let o=0,n=e.length;o<n;o++){t(e[o],o)}},N=(e,t)=>{const o=[],n=[];for(let r=0,l=e.length;r<l;r++){const l=e[r];(t(l,r)?o:n).push(l)}return{pass:o,fail:n}},A=(e,t)=>{const o=[];for(let n=0,r=e.length;n<r;n++){const r=e[n];t(r,n)&&o.push(r)}return o},B=(e,t,o)=>(((e,t)=>{for(let o=e.length-1;o>=0;o--)t(e[o],o)})(e,((e,n)=>{o=t(o,e,n)})),o),j=(e,t,o)=>(E(e,((e,n)=>{o=t(o,e,n)})),o),z=(e,t)=>((e,t,o)=>{for(let n=0,r=e.length;n<r;n++){const r=e[n];if(t(r,n))return Optional.some(r);if(o(r,n))break}return Optional.none()})(e,t,v),W=(e,t)=>{for(let o=0,n=e.length;o<n;o++){if(t(e[o],o))return Optional.some(o)}return Optional.none()},L=e=>{const t=[];for(let o=0,n=e.length;o<n;++o){if(!s(e[o]))throw new Error("Arr.flatten item "+o+" was not an array, input: "+e);T.apply(t,e[o])}return t},_=(e,t)=>L(k(e,t)),M=(e,t)=>{for(let o=0,n=e.length;o<n;++o){if(!0!==t(e[o],o))return!1}return!0},I=(e,t)=>{const o={};for(let n=0,r=e.length;n<r;n++){const r=e[n];o[String(r)]=t(r,n)}return o},P=(e,t)=>t>=0&&t<e.length?Optional.some(e[t]):Optional.none(),F=e=>P(e,0),H=e=>P(e,e.length-1),$=(e,t)=>{for(let o=0;o<e.length;o++){const n=t(e[o],o);if(n.isSome())return n}return Optional.none()},q=Object.keys,V=Object.hasOwnProperty,U=(e,t)=>{const o=q(e);for(let n=0,r=o.length;n<r;n++){const r=o[n];t(e[r],r)}},G=(e,t)=>K(e,((e,o)=>({k:o,v:t(e,o)}))),K=(e,t)=>{const o={};return U(e,((e,n)=>{const r=t(e,n);o[r.k]=r.v})),o},Y=(e,t)=>{const o={};return((e,t,o,n)=>{U(e,((e,r)=>{(t(e,r)?o:n)(e,r)}))})(e,t,(e=>(t,o)=>{e[o]=t})(o),p),o},J=(e,t)=>{const o=[];return U(e,((e,n)=>{o.push(t(e,n))})),o},Q=e=>J(e,g),X=(e,t)=>V.call(e,t);"undefined"!=typeof window?window:Function("return this;")();const Z=e=>e.dom.nodeName.toLowerCase(),ee=e=>e.dom.nodeType,te=e=>t=>ee(t)===e,oe=e=>8===ee(e)||"#comment"===Z(e),ne=te(1),re=te(3),le=te(9),se=te(11),ae=e=>t=>ne(t)&&Z(t)===e,ie=(e,t,o)=>{if(!(r(o)||i(o)||u(o)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",o,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,o+"")},ce=(e,t,o)=>{ie(e.dom,t,o)},me=(e,t)=>{const o=e.dom;U(t,((e,t)=>{ie(o,t,e)}))},de=(e,t)=>{const o=e.dom.getAttribute(t);return null===o?void 0:o},ue=(e,t)=>Optional.from(de(e,t)),pe=(e,t)=>{e.dom.removeAttribute(t)},fe=e=>j(e.dom.attributes,((e,t)=>(e[t.name]=t.value,e)),{}),ge=e=>{if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},he={fromHtml:(e,t)=>{const o=(t||document).createElement("div");if(o.innerHTML=e,!o.hasChildNodes()||o.childNodes.length>1){const t="HTML does not have a single root node";throw console.error(t,e),new Error(t)}return ge(o.childNodes[0])},fromTag:(e,t)=>{const o=(t||document).createElement(e);return ge(o)},fromText:(e,t)=>{const o=(t||document).createTextNode(e);return ge(o)},fromDom:ge,fromPoint:(e,t,o)=>Optional.from(e.dom.elementFromPoint(t,o)).map(ge)},be=(e,t)=>{const o=e.dom;if(1!==o.nodeType)return!1;{const e=o;if(void 0!==e.matches)return e.matches(t);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(t);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},we=e=>1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount,Oe=(e,t)=>{const o=void 0===t?document:t.dom;return we(o)?Optional.none():Optional.from(o.querySelector(e)).map(he.fromDom)},ve=(e,t)=>e.dom===t.dom,ye=(e,t)=>{const o=e.dom,n=t.dom;return o!==n&&o.contains(n)},Ce=be,xe=e=>he.fromDom(e.dom.ownerDocument),Te=e=>le(e)?e:xe(e),Se=e=>Optional.from(e.dom.parentNode).map(he.fromDom),Re=(e,t)=>{const o=d(t)?t:v;let n=e.dom;const r=[];for(;null!==n.parentNode&&void 0!==n.parentNode;){const e=n.parentNode,t=he.fromDom(e);if(r.push(t),!0===o(t))break;n=e}return r},De=e=>Optional.from(e.dom.previousSibling).map(he.fromDom),ke=e=>Optional.from(e.dom.nextSibling).map(he.fromDom),Ee=e=>k(e.dom.childNodes,he.fromDom),Ne=(e,t)=>{const o=e.dom.childNodes;return Optional.from(o[t]).map(he.fromDom)},Ae=(e,t)=>{Se(e).each((o=>{o.dom.insertBefore(t.dom,e.dom)}))},Be=(e,t)=>{ke(e).fold((()=>{Se(e).each((e=>{ze(e,t)}))}),(e=>{Ae(e,t)}))},je=(e,t)=>{const o=(e=>Ne(e,0))(e);o.fold((()=>{ze(e,t)}),(o=>{e.dom.insertBefore(t.dom,o.dom)}))},ze=(e,t)=>{e.dom.appendChild(t.dom)},We=(e,t)=>{Ae(e,t),ze(t,e)},Le=(e,t)=>{E(t,((o,n)=>{const r=0===n?e:t[n-1];Be(r,o)}))},_e=(e,t)=>{E(t,(t=>{ze(e,t)}))},Me=e=>{e.dom.textContent="",E(Ee(e),(e=>{Ie(e)}))},Ie=e=>{const t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},Pe=e=>{const t=Ee(e);t.length>0&&Le(e,t),Ie(e)},Fe=(e,t)=>he.fromDom(e.dom.cloneNode(t)),He=e=>Fe(e,!1),$e=e=>Fe(e,!0),qe=(e,t)=>{const o=he.fromTag(t),n=fe(e);return me(o,n),o},Ve=["tfoot","thead","tbody","colgroup"],Ue=(e,t,o)=>({element:e,rowspan:t,colspan:o}),Ge=(e,t,o)=>({element:e,cells:t,section:o}),Ke=(e,t,o)=>({element:e,isNew:t,isLocked:o}),Ye=(e,t,o,n)=>({element:e,cells:t,section:o,isNew:n}),Je=d(Element.prototype.attachShadow)&&d(Node.prototype.getRootNode),Qe=f(Je),Xe=Je?e=>he.fromDom(e.dom.getRootNode()):Te,Ze=e=>{const t=Xe(e);return se(o=t)&&m(o.dom.host)?Optional.some(t):Optional.none();var o},et=e=>he.fromDom(e.dom.host),tt=e=>m(e.dom.shadowRoot),ot=e=>{const t=re(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;const o=t.ownerDocument;return Ze(he.fromDom(t)).fold((()=>o.body.contains(t)),(n=ot,r=et,e=>n(r(e))));var n,r},nt=e=>{const t=e.dom.body;if(null==t)throw new Error("Body is not available yet");return he.fromDom(t)},rt=(e,t)=>{let o=[];return E(Ee(e),(e=>{t(e)&&(o=o.concat([e])),o=o.concat(rt(e,t))})),o},lt=(e,t,o)=>((e,t,o)=>A(Re(e,o),t))(e,(e=>be(e,t)),o),st=(e,t)=>((e,t)=>A(Ee(e),t))(e,(e=>be(e,t))),at=(e,t)=>((e,t)=>{const o=void 0===t?document:t.dom;return we(o)?[]:k(o.querySelectorAll(e),he.fromDom)})(t,e);var it=(e,t,o,n,r)=>e(o,n)?Optional.some(o):d(r)&&r(o)?Optional.none():t(o,n,r);const ct=(e,t,o)=>{let n=e.dom;const r=d(o)?o:v;for(;n.parentNode;){n=n.parentNode;const e=he.fromDom(n);if(t(e))return Optional.some(e);if(r(e))break}return Optional.none()},mt=(e,t,o)=>ct(e,(e=>be(e,t)),o),dt=(e,t)=>((e,t)=>z(e.dom.childNodes,(e=>t(he.fromDom(e)))).map(he.fromDom))(e,(e=>be(e,t))),ut=(e,t)=>Oe(t,e),pt=(e,t,o)=>it(((e,t)=>be(e,t)),mt,e,t,o),ft=(e,t,o=h)=>e.exists((e=>o(e,t))),gt=e=>{const t=[],o=e=>{t.push(e)};for(let n=0;n<e.length;n++)e[n].each(o);return t},ht=(e,t)=>e?Optional.some(t):Optional.none(),bt=(e,t,o)=>""===t||e.length>=t.length&&e.substr(o,o+t.length)===t,wt=(e,t,o=0,n)=>{const r=e.indexOf(t,o);return-1!==r&&(!!c(n)||r+t.length<=n)},Ot=(e,t)=>bt(e,t,0),vt=(e,t)=>bt(e,t,e.length-t.length),yt=(e=>t=>t.replace(e,""))(/^\s+|\s+$/g),Ct=e=>e.length>0,xt=e=>void 0!==e.style&&d(e.style.getPropertyValue),Tt=(e,t,o)=>{if(!r(o))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",o,":: Element ",e),new Error("CSS value must be a string: "+o);xt(e)&&e.style.setProperty(t,o)},St=(e,t,o)=>{const n=e.dom;Tt(n,t,o)},Rt=(e,t)=>{const o=e.dom;U(t,((e,t)=>{Tt(o,t,e)}))},Dt=(e,t)=>{const o=e.dom,n=window.getComputedStyle(o).getPropertyValue(t);return""!==n||ot(e)?n:kt(o,t)},kt=(e,t)=>xt(e)?e.style.getPropertyValue(t):"",Et=(e,t)=>{const o=e.dom,n=kt(o,t);return Optional.from(n).filter((e=>e.length>0))},Nt=(e,t)=>{((e,t)=>{xt(e)&&e.style.removeProperty(t)})(e.dom,t),ft(ue(e,"style").map(yt),"")&&pe(e,"style")},At=(e,t,o=0)=>ue(e,t).map((e=>parseInt(e,10))).getOr(o),Bt=(e,t)=>At(e,t,1),jt=e=>ae("col")(e)?At(e,"span",1)>1:Bt(e,"colspan")>1,zt=e=>Bt(e,"rowspan")>1,Wt=(e,t)=>parseInt(Dt(e,t),10),Lt=f(10),_t=f(10),Mt=(e,t)=>It(e,t,y),It=(e,t,o)=>_(Ee(e),(e=>be(e,t)?o(e)?[e]:[]:It(e,t,o))),Pt=(e,t)=>((e,t,o=v)=>o(t)?Optional.none():S(e,Z(t))?Optional.some(t):mt(t,e.join(","),(e=>be(e,"table")||o(e))))(["td","th"],e,t),Ft=e=>Mt(e,"th,td"),Ht=e=>be(e,"colgroup")?st(e,"col"):_(Vt(e),(e=>st(e,"col"))),$t=(e,t)=>pt(e,"table",t),qt=e=>Mt(e,"tr"),Vt=e=>$t(e).fold(f([]),(e=>st(e,"colgroup"))),Ut=(e,t)=>k(e,(e=>{if("colgroup"===Z(e)){const t=k(Ht(e),(e=>{const t=At(e,"span",1);return Ue(e,1,t)}));return Ge(e,t,"colgroup")}{const o=k(Ft(e),(e=>{const t=At(e,"rowspan",1),o=At(e,"colspan",1);return Ue(e,t,o)}));return Ge(e,o,t(e))}})),Gt=e=>Se(e).map((e=>{const t=Z(e);return(e=>S(Ve,e))(t)?t:"tbody"})).getOr("tbody"),Kt=e=>{const t=qt(e),o=[...Vt(e),...t];return Ut(o,Gt)},Yt=e=>{let t,o=!1;return(...n)=>(o||(o=!0,t=e.apply(null,n)),t)},Jt=()=>Qt(0,0),Qt=(e,t)=>({major:e,minor:t}),Xt={nu:Qt,detect:(e,t)=>{const o=String(t).toLowerCase();return 0===e.length?Jt():((e,t)=>{const o=((e,t)=>{for(let o=0;o<e.length;o++){const n=e[o];if(n.test(t))return n}})(e,t);if(!o)return{major:0,minor:0};const n=e=>Number(t.replace(o,"$"+e));return Qt(n(1),n(2))})(e,o)},unknown:Jt},Zt=(e,t)=>{const o=String(t).toLowerCase();return z(e,(e=>e.search(o)))},eo=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,to=e=>t=>wt(t,e),oo=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>wt(e,"edge/")&&wt(e,"chrome")&&wt(e,"safari")&&wt(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,eo],search:e=>wt(e,"chrome")&&!wt(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>wt(e,"msie")||wt(e,"trident")},{name:"Opera",versionRegexes:[eo,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:to("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:to("firefox")},{name:"Safari",versionRegexes:[eo,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(wt(e,"safari")||wt(e,"mobile/"))&&wt(e,"applewebkit")}],no=[{name:"Windows",search:to("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>wt(e,"iphone")||wt(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:to("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:to("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:to("linux"),versionRegexes:[]},{name:"Solaris",search:to("sunos"),versionRegexes:[]},{name:"FreeBSD",search:to("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:to("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],ro={browsers:f(oo),oses:f(no)},lo="Edge",so="Chromium",ao="Opera",io="Firefox",co="Safari",mo=e=>{const t=e.current,o=e.version,n=e=>()=>t===e;return{current:t,version:o,isEdge:n(lo),isChromium:n(so),isIE:n("IE"),isOpera:n(ao),isFirefox:n(io),isSafari:n(co)}},uo={unknown:()=>mo({current:void 0,version:Xt.unknown()}),nu:mo,edge:f(lo),chromium:f(so),ie:f("IE"),opera:f(ao),firefox:f(io),safari:f(co)},po="Windows",fo="Android",go="Linux",ho="macOS",bo="Solaris",wo="FreeBSD",Oo="ChromeOS",vo=e=>{const t=e.current,o=e.version,n=e=>()=>t===e;return{current:t,version:o,isWindows:n(po),isiOS:n("iOS"),isAndroid:n(fo),isMacOS:n(ho),isLinux:n(go),isSolaris:n(bo),isFreeBSD:n(wo),isChromeOS:n(Oo)}},yo={unknown:()=>vo({current:void 0,version:Xt.unknown()}),nu:vo,windows:f(po),ios:f("iOS"),android:f(fo),linux:f(go),macos:f(ho),solaris:f(bo),freebsd:f(wo),chromeos:f(Oo)},Co=(e,t,o)=>{const n=ro.browsers(),r=ro.oses(),l=t.bind((e=>((e,t)=>$(t.brands,(t=>{const o=t.brand.toLowerCase();return z(e,(e=>{var t;return o===(null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())})).map((e=>({current:e.name,version:Xt.nu(parseInt(t.version,10),0)})))})))(n,e))).orThunk((()=>((e,t)=>Zt(e,t).map((e=>{const o=Xt.detect(e.versionRegexes,t);return{current:e.name,version:o}})))(n,e))).fold(uo.unknown,uo.nu),s=((e,t)=>Zt(e,t).map((e=>{const o=Xt.detect(e.versionRegexes,t);return{current:e.name,version:o}})))(r,e).fold(yo.unknown,yo.nu),a=((e,t,o,n)=>{const r=e.isiOS()&&!0===/ipad/i.test(o),l=e.isiOS()&&!r,s=e.isiOS()||e.isAndroid(),a=s||n("(pointer:coarse)"),i=r||!l&&s&&n("(min-device-width:768px)"),c=l||s&&!i,m=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(o),d=!c&&!i&&!m;return{isiPad:f(r),isiPhone:f(l),isTablet:f(i),isPhone:f(c),isTouch:f(a),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:f(m),isDesktop:f(d)}})(s,l,e,o);return{browser:l,os:s,deviceType:a}},xo=e=>window.matchMedia(e).matches;let To=Yt((()=>Co(navigator.userAgent,Optional.from(navigator.userAgentData),xo)));const So=()=>To(),Ro=(e,t)=>{const o=o=>{const n=t(o);if(n<=0||null===n){const t=Dt(o,e);return parseFloat(t)||0}return n},n=(e,t)=>j(t,((t,o)=>{const n=Dt(e,o),r=void 0===n?0:parseInt(n,10);return isNaN(r)?t:t+r}),0);return{set:(t,o)=>{if(!u(o)&&!o.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+o);const n=t.dom;xt(n)&&(n.style[e]=o+"px")},get:o,getOuter:o,aggregate:n,max:(e,t,o)=>{const r=n(e,o);return t>r?t-r:0}}},Do=(e,t)=>(e=>{const t=parseFloat(e);return isNaN(t)?Optional.none():Optional.some(t)})(e).getOr(t),ko=(e,t,o)=>Do(Dt(e,t),o),Eo=(e,t)=>{const o=e.dom,n=o.getBoundingClientRect().width||o.offsetWidth;return"border-box"===t?n:((e,t,o,n)=>t-ko(e,`padding-${o}`,0)-ko(e,`padding-${n}`,0)-ko(e,`border-${o}-width`,0)-ko(e,`border-${n}-width`,0))(e,n,"left","right")},No=Ro("width",(e=>e.dom.offsetWidth)),Ao=e=>No.get(e),Bo=e=>No.getOuter(e),jo=e=>Eo(e,"content-box"),zo=e=>ko(e,"width",e.dom.offsetWidth),Wo=(e,t,o)=>{const n=e.cells,r=n.slice(0,t),l=n.slice(t),s=r.concat(o).concat(l);return Mo(e,s)},Lo=(e,t,o)=>Wo(e,t,[o]),_o=(e,t,o)=>{e.cells[t]=o},Mo=(e,t)=>Ye(e.element,t,e.section,e.isNew),Io=(e,t)=>e.cells[t],Po=(e,t)=>Io(e,t).element,Fo=e=>e.cells.length,Ho=e=>{const t=N(e,(e=>"colgroup"===e.section));return{rows:t.fail,cols:t.pass}},$o=(e,t,o)=>{const n=k(e.cells,o);return Ye(t(e.element),n,e.section,!0)},qo="data-snooker-locked-cols",Vo=e=>ue(e,qo).bind((e=>Optional.from(e.match(/\d+/g)))).map((e=>I(e,y))),Uo=e=>{const t=j(Ho(e).rows,((e,t)=>(E(t.cells,((t,o)=>{t.isLocked&&(e[o]=!0)})),e)),{}),o=J(t,((e,t)=>parseInt(t,10)));return((e,t)=>{const o=C.call(e,0);return o.sort(t),o})(o)},Go=(e,t)=>e+","+t,Ko=(e,t)=>{const o=_(e.all,(e=>e.cells));return A(o,t)},Yo=e=>{const t={},o=[],n=F(e).map((e=>e.element)).bind($t).bind(Vo).getOr({});let r=0,l=0,s=0;const{pass:a,fail:i}=N(e,(e=>"colgroup"===e.section));E(i,(e=>{const a=[];E(e.cells,(e=>{let o=0;for(;void 0!==t[Go(s,o)];)o++;const r=((e,t)=>X(e,t)&&void 0!==e[t]&&null!==e[t])(n,o.toString()),i=((e,t,o,n,r,l)=>({element:e,rowspan:t,colspan:o,row:n,column:r,isLocked:l}))(e.element,e.rowspan,e.colspan,s,o,r);for(let n=0;n<e.colspan;n++)for(let r=0;r<e.rowspan;r++){const e=o+n,a=Go(s+r,e);t[a]=i,l=Math.max(l,e+1)}a.push(i)})),r++,o.push(Ge(e.element,a,e.section)),s++}));const{columns:c,colgroups:m}=H(a).map((e=>{const t=(e=>{const t={};let o=0;return E(e.cells,(e=>{const n=e.colspan;D(n,(r=>{const l=o+r;t[l]=((e,t,o)=>({element:e,colspan:t,column:o}))(e.element,n,l)})),o+=n})),t})(e),o=((e,t)=>({element:e,columns:t}))(e.element,Q(t));return{colgroups:[o],columns:t}})).getOrThunk((()=>({colgroups:[],columns:{}}))),d=((e,t)=>({rows:e,columns:t}))(r,l);return{grid:d,access:t,all:o,columns:c,colgroups:m}},Jo={fromTable:e=>{const t=Kt(e);return Yo(t)},generate:Yo,getAt:(e,t,o)=>Optional.from(e.access[Go(t,o)]),findItem:(e,t,o)=>{const n=Ko(e,(e=>o(t,e.element)));return n.length>0?Optional.some(n[0]):Optional.none()},filterItems:Ko,justCells:e=>_(e.all,(e=>e.cells)),justColumns:e=>Q(e.columns),hasColumns:e=>q(e.columns).length>0,getColumnAt:(e,t)=>Optional.from(e.columns[t])},Qo=(e,t=y)=>{const o=e.grid,n=D(o.columns,g),r=D(o.rows,g);return k(n,(o=>Xo((()=>_(r,(t=>Jo.getAt(e,t,o).filter((e=>e.column===o)).toArray()))),(e=>1===e.colspan&&t(e.element)),(()=>Jo.getAt(e,0,o)))))},Xo=(e,t,o)=>{const n=e();return z(n,t).orThunk((()=>Optional.from(n[0]).orThunk(o))).map((e=>e.element))},Zo=e=>{const t=e.grid,o=D(t.rows,g),n=D(t.columns,g);return k(o,(t=>Xo((()=>_(n,(o=>Jo.getAt(e,t,o).filter((e=>e.row===t)).fold(f([]),(e=>[e]))))),(e=>1===e.rowspan),(()=>Jo.getAt(e,t,0)))))},en=(e,t)=>{if(t<0||t>=e.length-1)return Optional.none();const o=e[t].fold((()=>{const o=(e=>{const t=C.call(e,0);return t.reverse(),t})(e.slice(0,t));return $(o,((e,t)=>e.map((e=>({value:e,delta:t+1})))))}),(e=>Optional.some({value:e,delta:0}))),n=e[t+1].fold((()=>{const o=e.slice(t+1);return $(o,((e,t)=>e.map((e=>({value:e,delta:t+1})))))}),(e=>Optional.some({value:e,delta:1})));return o.bind((e=>n.map((t=>{const o=t.delta+e.delta;return Math.abs(t.value-e.value)/o}))))},tn=(e,t)=>o=>"rtl"===on(o)?t:e,on=e=>"rtl"===Dt(e,"direction")?"rtl":"ltr",nn=Ro("height",(e=>{const t=e.dom;return ot(e)?t.getBoundingClientRect().height:t.offsetHeight})),rn=e=>nn.get(e),ln=e=>nn.getOuter(e),sn=e=>ko(e,"height",e.dom.offsetHeight),an=(e,t)=>({left:e,top:t,translate:(o,n)=>an(e+o,t+n)}),cn=an,mn=(e,t)=>void 0!==e?e:void 0!==t?t:0,dn=e=>{const t=e.dom.ownerDocument,o=t.body,n=t.defaultView,r=t.documentElement;if(o===e.dom)return cn(o.offsetLeft,o.offsetTop);const l=mn(null==n?void 0:n.pageYOffset,r.scrollTop),s=mn(null==n?void 0:n.pageXOffset,r.scrollLeft),a=mn(r.clientTop,o.clientTop),i=mn(r.clientLeft,o.clientLeft);return un(e).translate(s-i,l-a)},un=e=>{const t=e.dom,o=t.ownerDocument.body;return o===t?cn(o.offsetLeft,o.offsetTop):ot(e)?(e=>{const t=e.getBoundingClientRect();return cn(t.left,t.top)})(t):cn(0,0)},pn=(e,t)=>({row:e,y:t}),fn=(e,t)=>({col:e,x:t}),gn=e=>dn(e).left+Bo(e),hn=e=>dn(e).left,bn=(e,t)=>fn(e,hn(t)),wn=(e,t)=>fn(e,gn(t)),On=e=>dn(e).top,vn=(e,t)=>pn(e,On(t)),yn=(e,t)=>pn(e,On(t)+ln(t)),Cn=(e,t,o)=>{if(0===o.length)return[];const n=k(o.slice(1),((t,o)=>t.map((t=>e(o,t))))),r=o[o.length-1].map((e=>t(o.length-1,e)));return n.concat([r])},xn={delta:g,positions:e=>Cn(vn,yn,e),edge:On},Tn=tn({delta:g,edge:hn,positions:e=>Cn(bn,wn,e)},{delta:e=>-e,edge:gn,positions:e=>Cn(wn,bn,e)}),Sn={delta:(e,t)=>Tn(t).delta(e,t),positions:(e,t)=>Tn(t).positions(e,t),edge:e=>Tn(e).edge(e)},Rn={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},Dn=(()=>{const e="[0-9]+",t="[eE]"+("[+-]?"+e),o=e=>`(?:${e})?`,n=["Infinity",e+"\\."+o(e)+o(t),"\\."+e+o(t),e+o(t)].join("|");return new RegExp(`^(${`[+-]?(?:${n})`})(.*)$`)})(),kn=(e,t)=>Optional.from(Dn.exec(e)).bind((e=>{const o=Number(e[1]),n=e[2];return((e,t)=>R(t,(t=>R(Rn[t],(t=>e===t)))))(n,t)?Optional.some({value:o,unit:n}):Optional.none()})),En=/(\d+(\.\d+)?)%/,Nn=/(\d+(\.\d+)?)px|em/,An=ae("col"),Bn=(e,t,o)=>{const n=(r=e,Optional.from(r.dom.parentElement).map(he.fromDom)).getOrThunk((()=>nt(xe(e))));var r;return t(e)/o(n)*100},jn=(e,t)=>{St(e,"width",t+"px")},zn=(e,t)=>{St(e,"width",t+"%")},Wn=(e,t)=>{St(e,"height",t+"px")},Ln=(e,t,o,n)=>{const r=parseFloat(e);return vt(e,"%")&&"table"!==Z(t)?((e,t,o,n)=>{const r=$t(e).map((e=>{const n=o(e);return Math.floor(t/100*n)})).getOr(t);return n(e,r),r})(t,r,o,n):r},_n=e=>{const t=(e=>sn(e)+"px")(e);return t?Ln(t,e,rn,Wn):rn(e)},Mn=(e,t)=>Et(e,t).orThunk((()=>ue(e,t).map((e=>e+"px")))),In=e=>Mn(e,"width"),Pn=e=>Bn(e,Ao,jo),Fn=e=>An(e)?Ao(e):zo(e),Hn=e=>((e,t,o)=>o(e)/Bt(e,t))(e,"rowspan",_n),$n=(e,t,o)=>{St(e,"width",t+o)},qn=e=>Bn(e,Ao,jo)+"%",Vn=f(En),Un=ae("col"),Gn=e=>In(e).getOrThunk((()=>Fn(e)+"px")),Kn=e=>{return(t=e,Mn(t,"height")).getOrThunk((()=>Hn(e)+"px"));var t},Yn=(e,t,o,n,r,l)=>e.filter(n).fold((()=>l(en(o,t))),(e=>r(e))),Jn=(e,t,o,n)=>{const r=Qo(e),l=Jo.hasColumns(e)?(e=>k(Jo.justColumns(e),(e=>Optional.from(e.element))))(e):r,s=[Optional.some(Sn.edge(t))].concat(k(Sn.positions(r,t),(e=>e.map((e=>e.x))))),a=w(jt);return k(l,((e,t)=>Yn(e,t,s,a,(e=>{if((e=>{const t=So().browser,o=t.isChromium()||t.isFirefox();return!Un(e)||o})(e))return o(e);{const e=(l=r[t],i=g,null!=l?i(l):Optional.none());return Yn(e,t,s,a,(e=>n(Optional.some(Ao(e)))),n)}var l,i}),n)))},Qn=e=>e.map((e=>e+"px")).getOr(""),Xn=(e,t,o)=>Jn(e,t,Fn,(e=>e.getOrThunk(o.minCellWidth))),Zn=(e,t,o,n,r)=>{const l=Zo(e),s=[Optional.some(o.edge(t))].concat(k(o.positions(l,t),(e=>e.map((e=>e.y)))));return k(l,((e,t)=>Yn(e,t,s,w(zt),n,r)))},er=(e,t)=>()=>ot(e)?t(e):parseFloat(Et(e,"width").getOr("0")),tr=e=>{const t=er(e,Ao),o=f(0);return{width:t,pixelWidth:t,getWidths:(t,o)=>Xn(t,e,o),getCellDelta:o,singleColumnWidth:f([0]),minCellWidth:o,setElementWidth:p,adjustTableWidth:p,isRelative:!0,label:"none"}},or=e=>{const t=er(e,(e=>parseFloat(qn(e)))),o=er(e,Ao);return{width:t,pixelWidth:o,getWidths:(t,o)=>((e,t,o)=>Jn(e,t,Pn,(e=>e.fold((()=>o.minCellWidth()),(e=>e/o.pixelWidth()*100)))))(t,e,o),getCellDelta:e=>e/o()*100,singleColumnWidth:(e,t)=>[100-e],minCellWidth:()=>Lt()/o()*100,setElementWidth:zn,adjustTableWidth:o=>{const n=t();zn(e,n+o/100*n)},isRelative:!0,label:"percent"}},nr=e=>{const t=er(e,Ao);return{width:t,pixelWidth:t,getWidths:(t,o)=>Xn(t,e,o),getCellDelta:g,singleColumnWidth:(e,t)=>[Math.max(Lt(),e+t)-e],minCellWidth:Lt,setElementWidth:jn,adjustTableWidth:o=>{const n=t()+o;jn(e,n)},isRelative:!1,label:"pixel"}},rr=e=>In(e).fold((()=>tr(e)),(t=>((e,t)=>null!==Vn().exec(t)?or(e):nr(e))(e,t))),lr=nr,sr=or,ar=(e,t,o)=>{const n=e[o].element,r=he.fromTag("td");ze(r,he.fromTag("br"));(t?ze:je)(n,r)},ir=(e,t)=>{const o=e=>be(e.element,t),n=$e(e),r=Kt(n),l=rr(e),s=Jo.generate(r),a=((e,t)=>{const o=e.grid.columns;let n=e.grid.rows,r=o,l=0,s=0;const a=[],i=[];return U(e.access,(e=>{if(a.push(e),t(e)){i.push(e);const t=e.row,o=t+e.rowspan-1,a=e.column,c=a+e.colspan-1;t<n?n=t:o>l&&(l=o),a<r?r=a:c>s&&(s=c)}})),((e,t,o,n,r,l)=>({minRow:e,minCol:t,maxRow:o,maxCol:n,allCells:r,selectedCells:l}))(n,r,l,s,a,i)})(s,o),i="th:not("+t+"),td:not("+t+")",c=It(n,"th,td",(e=>be(e,i)));E(c,Ie),((e,t,o,n)=>{const r=A(e,(e=>"colgroup"!==e.section)),l=t.grid.columns,s=t.grid.rows;for(let a=0;a<s;a++){let e=!1;for(let s=0;s<l;s++)a<o.minRow||a>o.maxRow||s<o.minCol||s>o.maxCol||(Jo.getAt(t,a,s).filter(n).isNone()?ar(r,e,a):e=!0)}})(r,s,a,o);const m=((e,t,o,n)=>{if(0===n.minCol&&t.grid.columns===n.maxCol+1)return 0;const r=Xn(t,e,o),l=j(r,((e,t)=>e+t),0),s=j(r.slice(n.minCol,n.maxCol+1),((e,t)=>e+t),0),a=s/l*o.pixelWidth()-o.pixelWidth();return o.getCellDelta(a)})(e,Jo.fromTable(e),l,a);return((e,t,o,n)=>{U(o.columns,(e=>{(e.column<t.minCol||e.column>t.maxCol)&&Ie(e.element)}));const r=A(Mt(e,"tr"),(e=>0===e.dom.childElementCount));E(r,Ie),t.minCol!==t.maxCol&&t.minRow!==t.maxRow||E(Mt(e,"th,td"),(e=>{pe(e,"rowspan"),pe(e,"colspan")})),pe(e,qo),pe(e,"data-snooker-col-series"),rr(e).adjustTableWidth(n)})(n,a,s,m),n},cr=((e,t)=>{const o=t=>e(t)?Optional.from(t.dom.nodeValue):Optional.none();return{get:n=>{if(!e(n))throw new Error("Can only get "+t+" value of a "+t+" node");return o(n).getOr("")},getOption:o,set:(o,n)=>{if(!e(o))throw new Error("Can only set raw "+t+" value of a "+t+" node");o.dom.nodeValue=n}}})(re,"text"),mr=e=>cr.get(e),dr=e=>cr.getOption(e),ur=(e,t)=>cr.set(e,t),pr=e=>"img"===Z(e)?1:dr(e).fold((()=>Ee(e).length),(e=>e.length)),fr=["img","br"],gr=e=>dr(e).filter((e=>0!==e.trim().length||e.indexOf("\xa0")>-1)).isSome()||S(fr,Z(e)),hr=e=>((e,t)=>{const o=e=>{for(let n=0;n<e.childNodes.length;n++){const r=he.fromDom(e.childNodes[n]);if(t(r))return Optional.some(r);const l=o(e.childNodes[n]);if(l.isSome())return l}return Optional.none()};return o(e.dom)})(e,gr),br=e=>wr(e,gr),wr=(e,t)=>{const o=e=>{const n=Ee(e);for(let r=n.length-1;r>=0;r--){const e=n[r];if(t(e))return Optional.some(e);const l=o(e);if(l.isSome())return l}return Optional.none()};return o(e)},Or={scope:["row","col"]},vr=e=>()=>{const t=he.fromTag("td",e.dom);return ze(t,he.fromTag("br",e.dom)),t},yr=e=>()=>he.fromTag("col",e.dom),Cr=e=>()=>he.fromTag("colgroup",e.dom),xr=e=>()=>he.fromTag("tr",e.dom),Tr=(e,t,o)=>{const n=((e,t)=>{const o=qe(e,t),n=Ee($e(e));return _e(o,n),o})(e,t);return U(o,((e,t)=>{null===e?pe(n,t):ce(n,t,e)})),n},Sr=e=>e,Rr=(e,t,o)=>{const n=(e,t)=>{((e,t)=>{const o=e.dom,n=t.dom;xt(o)&&xt(n)&&(n.style.cssText=o.style.cssText)})(e.element,t),Nt(t,"height"),1!==e.colspan&&Nt(t,"width")};return{col:o=>{const r=he.fromTag(Z(o.element),t.dom);return n(o,r),e(o.element,r),r},colgroup:Cr(t),row:xr(t),cell:r=>{const l=he.fromTag(Z(r.element),t.dom),s=o.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),a=s.length>0?((e,t,o)=>hr(e).map((n=>{const r=o.join(","),l=lt(n,r,(t=>ve(t,e)));return B(l,((e,t)=>{const o=He(t);return pe(o,"contenteditable"),ze(e,o),o}),t)})).getOr(t))(r.element,l,s):l;return ze(a,he.fromTag("br")),n(r,l),((e,t)=>{U(Or,((o,n)=>ue(e,n).filter((e=>S(o,e))).each((e=>ce(t,n,e)))))})(r.element,l),e(r.element,l),l},replace:Tr,colGap:yr(t),gap:vr(t)}},Dr=e=>({col:yr(e),colgroup:Cr(e),row:xr(e),cell:vr(e),replace:Sr,colGap:yr(e),gap:vr(e)}),kr=e=>he.fromDom(e.getBody()),Er=e=>t=>ve(t,kr(e)),Nr=e=>{pe(e,"data-mce-style");const t=e=>pe(e,"data-mce-style");E(Ft(e),t),E(Ht(e),t),E(qt(e),t)},Ar=e=>he.fromDom(e.selection.getStart()),Br=e=>e.getBoundingClientRect().width,jr=e=>e.getBoundingClientRect().height,zr=(e,t)=>{const o=t.column,n=t.column+t.colspan-1,r=t.row,l=t.row+t.rowspan-1;return o<=e.finishCol&&n>=e.startCol&&r<=e.finishRow&&l>=e.startRow},Wr=(e,t)=>t.column>=e.startCol&&t.column+t.colspan-1<=e.finishCol&&t.row>=e.startRow&&t.row+t.rowspan-1<=e.finishRow,Lr=(e,t,o)=>{const n=Jo.findItem(e,t,ve),r=Jo.findItem(e,o,ve);return n.bind((e=>r.map((t=>{return o=e,n=t,r=Math.min(o.row,n.row),l=Math.min(o.column,n.column),s=Math.max(o.row+o.rowspan-1,n.row+n.rowspan-1),a=Math.max(o.column+o.colspan-1,n.column+n.colspan-1),{startRow:r,startCol:l,finishRow:s,finishCol:a};var o,n,r,l,s,a}))))},_r=(e,t,o)=>Lr(e,t,o).bind((t=>((e,t)=>{let o=!0;const n=b(Wr,t);for(let r=t.startRow;r<=t.finishRow;r++)for(let l=t.startCol;l<=t.finishCol;l++)o=o&&Jo.getAt(e,r,l).exists(n);return o?Optional.some(t):Optional.none()})(e,t))),Mr=(e,t,o)=>Lr(e,t,o).map((t=>{const o=Jo.filterItems(e,b(zr,t));return k(o,(e=>e.element))})),Ir=(e,t)=>Jo.findItem(e,t,((e,t)=>ye(t,e))).map((e=>e.element)),Pr=(e,t,o)=>$t(e).bind((n=>((e,t,o,n)=>Jo.findItem(e,t,ve).bind((t=>{const r=o>0?t.row+t.rowspan-1:t.row,l=n>0?t.column+t.colspan-1:t.column;return Jo.getAt(e,r+o,l+n).map((e=>e.element))})))($r(n),e,t,o))),Fr=(e,t,o)=>{const n=$r(e);return Mr(n,t,o)},Hr=(e,t,o,n,r)=>{const l=$r(e),s=ve(e,o)?Optional.some(t):Ir(l,t),a=ve(e,r)?Optional.some(n):Ir(l,n);return s.bind((e=>a.bind((t=>Mr(l,e,t)))))},$r=Jo.fromTable;var qr=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],Vr=()=>({up:f({selector:mt,closest:pt,predicate:ct,all:Re}),down:f({selector:at,predicate:rt}),styles:f({get:Dt,getRaw:Et,set:St,remove:Nt}),attrs:f({get:de,set:ce,remove:pe,copyTo:(e,t)=>{const o=fe(e);me(t,o)}}),insert:f({before:Ae,after:Be,afterAll:Le,append:ze,appendAll:_e,prepend:je,wrap:We}),remove:f({unwrap:Pe,remove:Ie}),create:f({nu:he.fromTag,clone:e=>he.fromDom(e.dom.cloneNode(!1)),text:he.fromText}),query:f({comparePosition:(e,t)=>e.dom.compareDocumentPosition(t.dom),prevSibling:De,nextSibling:ke}),property:f({children:Ee,name:Z,parent:Se,document:e=>Te(e).dom,isText:re,isComment:oe,isElement:ne,isSpecial:e=>{const t=Z(e);return S(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],t)},getLanguage:e=>ne(e)?ue(e,"lang"):Optional.none(),getText:mr,setText:ur,isBoundary:e=>!!ne(e)&&("body"===Z(e)||S(qr,Z(e))),isEmptyTag:e=>!!ne(e)&&S(["br","img","hr","input"],Z(e)),isNonEditable:e=>ne(e)&&"false"===de(e,"contenteditable")}),eq:ve,is:Ce});const Ur=(e,t,o,n)=>{const r=t(e,o);return B(n,((o,n)=>{const r=t(e,n);return Gr(e,o,r)}),r)},Gr=(e,t,o)=>t.bind((t=>o.filter(b(e.eq,t)))),Kr=(e,t,o)=>o.length>0?((e,t,o,n)=>n(e,t,o[0],o.slice(1)))(e,t,o,Ur):Optional.none(),Yr=(e,t,o,n=v)=>{const r=[t].concat(e.up().all(t)),l=[o].concat(e.up().all(o)),s=e=>W(e,n).fold((()=>e),(t=>e.slice(0,t+1))),a=s(r),i=s(l),c=z(a,(t=>R(i,((e,t)=>b(e.eq,t))(e,t))));return{firstpath:a,secondpath:i,shared:c}},Jr=Vr(),Qr=(e,t)=>Kr(Jr,((t,o)=>e(o)),t),Xr=e=>mt(e,"table"),Zr=(e,t,o)=>{const n=e=>t=>void 0!==o&&o(t)||ve(t,e);return ve(e,t)?Optional.some({boxes:Optional.some([e]),start:e,finish:t}):Xr(e).bind((r=>Xr(t).bind((l=>{if(ve(r,l))return Optional.some({boxes:Fr(r,e,t),start:e,finish:t});if(ye(r,l)){const o=lt(t,"td,th",n(r)),s=o.length>0?o[o.length-1]:t;return Optional.some({boxes:Hr(r,e,r,t,l),start:e,finish:s})}if(ye(l,r)){const o=lt(e,"td,th",n(l)),s=o.length>0?o[o.length-1]:e;return Optional.some({boxes:Hr(l,e,r,t,l),start:e,finish:s})}return((e,t,o)=>Yr(Jr,e,t,o))(e,t).shared.bind((s=>pt(s,"table",o).bind((o=>{const s=lt(t,"td,th",n(o)),a=s.length>0?s[s.length-1]:t,i=lt(e,"td,th",n(o)),c=i.length>0?i[i.length-1]:e;return Optional.some({boxes:Hr(o,e,r,t,l),start:c,finish:a})}))))}))))},el=(e,t)=>{const o=at(e,t);return o.length>0?Optional.some(o):Optional.none()},tl=(e,t,o)=>ut(e,t).bind((t=>ut(e,o).bind((e=>Qr(Xr,[t,e]).map((o=>({first:t,last:e,table:o}))))))),ol=(e,t,o,n,r)=>((e,t)=>z(e,(e=>be(e,t))))(e,r).bind((e=>Pr(e,t,o).bind((e=>((e,t)=>mt(e,"table").bind((o=>ut(o,t).bind((t=>Zr(t,e).bind((e=>e.boxes.map((t=>({boxes:t,start:e.start,finish:e.finish}))))))))))(e,n))))),nl=(e,t)=>el(e,t),rl=(e,t,o)=>tl(e,t,o).bind((t=>{const o=t=>ve(e,t),n="thead,tfoot,tbody,table",r=mt(t.first,n,o),l=mt(t.last,n,o);return r.bind((e=>l.bind((o=>ve(e,o)?((e,t,o)=>{const n=$r(e);return _r(n,t,o)})(t.table,t.first,t.last):Optional.none()))))})),ll=g,sl=e=>{const t=(e,t)=>ue(e,t).exists((e=>parseInt(e,10)>1));return e.length>0&&M(e,(e=>t(e,"rowspan")||t(e,"colspan")))?Optional.some(e):Optional.none()},al=(e,t,o)=>t.length<=1?Optional.none():rl(e,o.firstSelectedSelector,o.lastSelectedSelector).map((e=>({bounds:e,cells:t}))),il="data-mce-selected",cl="td["+il+"],th["+il+"]",ml="["+il+"]",dl="data-mce-first-selected",ul="td["+dl+"],th["+dl+"]",pl="data-mce-last-selected",fl="td["+pl+"],th["+pl+"]",gl=ml,hl={selected:il,selectedSelector:cl,firstSelected:dl,firstSelectedSelector:ul,lastSelected:pl,lastSelectedSelector:fl},bl=(e,t,o)=>({element:o,mergable:al(t,e,hl),unmergable:sl(e),selection:ll(e)}),wl=e=>(t,o)=>{const n=Z(t),r="col"===n||"colgroup"===n?$t(l=t).bind((e=>nl(e,hl.firstSelectedSelector))).fold(f(l),(e=>e[0])):t;var l;return pt(r,e,o)},Ol=wl("th,td,caption"),vl=wl("th,td"),yl=e=>{return t=e.model.table.getSelectedCells(),k(t,he.fromDom);var t},Cl=(e,t)=>{e.on("BeforeGetContent",(t=>{const o=o=>{t.preventDefault(),(e=>$t(e[0]).map((e=>{const t=ir(e,gl);return Nr(t),[t]})))(o).each((o=>{t.content="text"===t.format?(e=>k(e,(e=>e.dom.innerText)).join(""))(o):((e,t)=>k(t,(t=>e.selection.serializer.serialize(t.dom,{}))).join(""))(e,o)}))};if(!0===t.selection){const t=(e=>A(yl(e),(e=>be(e,hl.selectedSelector))))(e);t.length>=1&&o(t)}})),e.on("BeforeSetContent",(o=>{if(!0===o.selection&&!0===o.paste){const n=yl(e);F(n).each((n=>{$t(n).each((r=>{const l=A(((e,t)=>{const o=(t||document).createElement("div");return o.innerHTML=e,Ee(he.fromDom(o))})(o.content),(e=>"meta"!==Z(e))),s=ae("table");if(1===l.length&&s(l[0])){o.preventDefault();const s=he.fromDom(e.getDoc()),a=Dr(s),i=((e,t,o)=>({element:e,clipboard:t,generators:o}))(n,l[0],a);t.pasteCells(r,i).each((()=>{e.focus()}))}}))}))}}))},xl=(e,t)=>({element:e,offset:t}),Tl=(e,t,o)=>e.property().isText(t)&&0===e.property().getText(t).trim().length||e.property().isComment(t)?o(t).bind((t=>Tl(e,t,o).orThunk((()=>Optional.some(t))))):Optional.none(),Sl=(e,t)=>{if(e.property().isText(t))return e.property().getText(t).length;return e.property().children(t).length},Rl=(e,t)=>{const o=Tl(e,t,e.query().prevSibling).getOr(t);if(e.property().isText(o))return xl(o,Sl(e,o));const n=e.property().children(o);return n.length>0?Rl(e,n[n.length-1]):xl(o,Sl(e,o))},Dl=Rl,kl=Vr(),El=(e,t)=>{if(!jt(e)){const o=(e=>In(e).bind((e=>kn(e,["fixed","relative","empty"]))))(e);o.each((o=>{const n=o.value/2;$n(e,n,o.unit),$n(t,n,o.unit)}))}},Nl=e=>k(e,f(0)),Al=(e,t,o,n,r)=>r(e.slice(0,t)).concat(n).concat(r(e.slice(o))),Bl=e=>(t,o,n,r)=>{if(e(n)){const e=Math.max(r,t[o]-Math.abs(n)),l=Math.abs(e-t[o]);return n>=0?l:-l}return n},jl=Bl((e=>e<0)),zl=Bl(y),Wl=()=>{const e=(e,t,o,n)=>{const r=(100+o)/100,l=Math.max(n,(e[t]+o)/r);return k(e,((e,o)=>(o===t?l:e/r)-e))},t=(t,o,n,r,l,s)=>s?e(t,o,r,l):((e,t,o,n,r)=>{const l=jl(e,t,n,r);return Al(e,t,o+1,[l,0],Nl)})(t,o,n,r,l);return{resizeTable:(e,t)=>e(t),clampTableDelta:jl,calcLeftEdgeDeltas:t,calcMiddleDeltas:(e,o,n,r,l,s,a)=>t(e,n,r,l,s,a),calcRightEdgeDeltas:(t,o,n,r,l,s)=>{if(s)return e(t,n,r,l);{const e=jl(t,n,r,l);return Nl(t.slice(0,n)).concat([e])}},calcRedestributedWidths:(e,t,o,n)=>{if(n){const n=(t+o)/t,r=k(e,(e=>e/n));return{delta:100*n-100,newSizes:r}}return{delta:o,newSizes:e}}}},Ll=()=>{const e=(e,t,o,n,r)=>{const l=zl(e,n>=0?o:t,n,r);return Al(e,t,o+1,[l,-l],Nl)};return{resizeTable:(e,t,o)=>{o&&e(t)},clampTableDelta:(e,t,o,n,r)=>{if(r){if(o>=0)return o;{const t=j(e,((e,t)=>e+t-n),0);return Math.max(-t,o)}}return jl(e,t,o,n)},calcLeftEdgeDeltas:e,calcMiddleDeltas:(t,o,n,r,l,s)=>e(t,n,r,l,s),calcRightEdgeDeltas:(e,t,o,n,r,l)=>{if(l)return Nl(e);{const t=n/e.length;return k(e,f(t))}},calcRedestributedWidths:(e,t,o,n)=>({delta:0,newSizes:e})}},_l=e=>Jo.fromTable(e).grid,Ml=ae("th"),Il=e=>M(e,(e=>Ml(e.element))),Pl=(e,t)=>e&&t?"sectionCells":e?"section":"cells",Fl=e=>{const t="thead"===e.section,o=ft(Hl(e.cells),"th");return"tfoot"===e.section?{type:"footer"}:t||o?{type:"header",subType:Pl(t,o)}:{type:"body"}},Hl=e=>{const t=A(e,(e=>Ml(e.element)));return 0===t.length?Optional.some("td"):t.length===e.length?Optional.some("th"):Optional.none()},$l=(e,t,o)=>Ke(o(e.element,t),!0,e.isLocked),ql=(e,t)=>e.section!==t?Ye(e.element,e.cells,t,e.isNew):e,Vl=()=>({transformRow:ql,transformCell:(e,t,o)=>{const n=o(e.element,t),r="td"!==Z(n)?((e,t)=>{const o=qe(e,t);Be(e,o);const n=Ee(e);return _e(o,n),Ie(e),o})(n,"td"):n;return Ke(r,e.isNew,e.isLocked)}}),Ul=()=>({transformRow:ql,transformCell:$l}),Gl=()=>({transformRow:(e,t)=>ql(e,"thead"===t?"tbody":t),transformCell:$l}),Kl=(e,t)=>{const o=(e=>$(e.all,(e=>{const t=Fl(e);return"header"===t.type?Optional.from(t.subType):Optional.none()})))(Jo.fromTable(e)).getOr(t);switch(o){case"section":return Vl();case"sectionCells":return Ul();case"cells":return Gl()}},Yl=Vl,Jl=Ul,Ql=Gl,Xl=()=>({transformRow:g,transformCell:$l}),Zl=e=>pt(e,"[contenteditable]"),es=(e,t=!1)=>ot(e)?e.dom.isContentEditable:Zl(e).fold(f(t),(e=>"true"===ts(e))),ts=e=>e.dom.contentEditable,os=(e,t,o,n)=>{o===n?pe(e,t):ce(e,t,o)},ns=(e,t,o)=>{H(st(e,t)).fold((()=>je(e,o)),(e=>Be(e,o)))},rs=(e,t)=>{const o=[],n=[],r=e=>k(e,(e=>{e.isNew&&o.push(e.element);const t=e.element;return Me(t),E(e.cells,(e=>{e.isNew&&n.push(e.element),os(e.element,"colspan",e.colspan,1),os(e.element,"rowspan",e.rowspan,1),ze(t,e.element)})),t})),l=e=>_(e,(e=>k(e.cells,(e=>(os(e.element,"span",e.colspan,1),e.element))))),s=(t,o)=>{const n=((e,t)=>{const o=dt(e,t).getOrThunk((()=>{const o=he.fromTag(t,xe(e).dom);return"thead"===t?ns(e,"caption,colgroup",o):"colgroup"===t?ns(e,"caption",o):ze(e,o),o}));return Me(o),o})(e,o),s=("colgroup"===o?l:r)(t);_e(n,s)},a=(t,o)=>{t.length>0?s(t,o):(t=>{dt(e,t).each(Ie)})(o)},i=[],c=[],m=[],d=[];return E(t,(e=>{switch(e.section){case"thead":i.push(e);break;case"tbody":c.push(e);break;case"tfoot":m.push(e);break;case"colgroup":d.push(e)}})),a(d,"colgroup"),a(i,"thead"),a(c,"tbody"),a(m,"tfoot"),{newRows:o,newCells:n}},ls=(e,t)=>{if(0===e.length)return 0;const o=e[0];return W(e,(e=>!t(o.element,e.element))).getOr(e.length)},ss=(e,t,o,n)=>{const r=((e,t)=>e[t])(e,t),l="colgroup"===r.section,s=ls(r.cells.slice(o),n),a=l?1:ls(((e,t)=>k(e,(e=>Io(e,t))))(e.slice(t),o),n);return{colspan:s,rowspan:a}},as=(e,t)=>{const o=k(e,(e=>k(e.cells,v)));return k(e,((n,r)=>{const l=_(n.cells,((n,l)=>{if(!1===o[r][l]){const m=ss(e,r,l,t);return((e,t,n,r)=>{for(let l=e;l<e+n;l++)for(let e=t;e<t+r;e++)o[l][e]=!0})(r,l,m.rowspan,m.colspan),[(s=n.element,a=m.rowspan,i=m.colspan,c=n.isNew,{element:s,rowspan:a,colspan:i,isNew:c})]}return[];var s,a,i,c}));return((e,t,o,n)=>({element:e,cells:t,section:o,isNew:n}))(n.element,l,n.section,n.isNew)}))},is=(e,t,o)=>{const n=[];E(e.colgroups,(r=>{const l=[];for(let n=0;n<e.grid.columns;n++){const r=Jo.getColumnAt(e,n).map((e=>Ke(e.element,o,!1))).getOrThunk((()=>Ke(t.colGap(),!0,!1)));l.push(r)}n.push(Ye(r.element,l,"colgroup",o))}));for(let r=0;r<e.grid.rows;r++){const l=[];for(let n=0;n<e.grid.columns;n++){const s=Jo.getAt(e,r,n).map((e=>Ke(e.element,o,e.isLocked))).getOrThunk((()=>Ke(t.gap(),!0,!1)));l.push(s)}const s=e.all[r],a=Ye(s.element,l,s.section,o);n.push(a)}return n},cs=e=>as(e,ve),ms=(e,t)=>$(e.all,(e=>z(e.cells,(e=>ve(t,e.element))))),ds=(e,t,o)=>{const n=k(t.selection,(t=>Pt(t).bind((t=>ms(e,t))).filter(o))),r=gt(n);return ht(r.length>0,r)},us=(e,t,o,n,r)=>(l,s,a,i)=>{const c=Jo.fromTable(l),m=Optional.from(null==i?void 0:i.section).getOrThunk(Xl);return t(c,s).map((t=>{const o=((e,t)=>is(e,t,!1))(c,a),n=e(o,t,ve,r(a),m),l=Uo(n.grid);return{info:t,grid:cs(n.grid),cursor:n.cursor,lockedColumns:l}})).bind((e=>{const t=rs(l,e.grid),r=Optional.from(null==i?void 0:i.sizing).getOrThunk((()=>rr(l))),s=Optional.from(null==i?void 0:i.resize).getOrThunk(Ll);return o(l,e.grid,e.info,{sizing:r,resize:s,section:m}),n(l),pe(l,qo),e.lockedColumns.length>0&&ce(l,qo,e.lockedColumns.join(",")),Optional.some({cursor:e.cursor,newRows:t.newRows,newCells:t.newCells})}))},ps=(e,t)=>ds(e,t,y).map((e=>({cells:e,generators:t.generators,clipboard:t.clipboard}))),fs=(e,t)=>ds(e,t,y),gs=(e,t)=>ds(e,t,(e=>!e.isLocked)),hs=(e,t)=>M(t,(t=>((e,t)=>ms(e,t).exists((e=>!e.isLocked)))(e,t))),bs=(e,t,o,n)=>{const r=Ho(e).rows;let l=!0;for(let s=0;s<r.length;s++)for(let e=0;e<Fo(r[0]);e++){const a=r[s],i=Io(a,e),c=o(i.element,t);c&&!l?_o(a,e,Ke(n(),!0,i.isLocked)):c&&(l=!1)}return e},ws=(e,t,o,n)=>{const r=Ho(e).rows;if(t>0&&t<r.length){const e=((e,t)=>j(e,((e,o)=>R(e,(e=>t(e.element,o.element)))?e:e.concat([o])),[]))(r[t-1].cells,o);E(e,(e=>{let l=Optional.none();for(let s=t;s<r.length;s++)for(let t=0;t<Fo(r[0]);t++){const a=r[s],i=Io(a,t);o(i.element,e.element)&&(l.isNone()&&(l=Optional.some(n())),l.each((e=>{_o(a,t,Ke(e,!0,i.isLocked))})))}}))}return e},Os=e=>{const t=t=>t(e),o=f(e),n=()=>r,r={tag:!0,inner:e,fold:(t,o)=>o(e),isValue:y,isError:v,map:t=>ys.value(t(e)),mapError:n,bind:t,exists:t,forall:t,getOr:o,or:n,getOrThunk:o,orThunk:n,getOrDie:o,each:t=>{t(e)},toOptional:()=>Optional.some(e)};return r},vs=e=>{const t=()=>o,o={tag:!1,inner:e,fold:(t,o)=>t(e),isValue:v,isError:y,map:t,mapError:t=>ys.error(t(e)),bind:t,exists:v,forall:y,getOr:g,or:g,getOrThunk:O,orThunk:O,getOrDie:(n=String(e),()=>{throw new Error(n)}),each:p,toOptional:Optional.none};var n;return o},ys={value:Os,error:vs,fromOption:(e,t)=>e.fold((()=>vs(t)),Os)},Cs=(e,t)=>({rowDelta:0,colDelta:Fo(e[0])-Fo(t[0])}),xs=(e,t)=>({rowDelta:e.length-t.length,colDelta:0}),Ts=(e,t,o,n)=>{const r="colgroup"===t.section?o.col:o.cell;return D(e,(e=>Ke(r(),!0,n(e))))},Ss=(e,t,o,n)=>{const r=e[e.length-1];return e.concat(D(t,(()=>{const e="colgroup"===r.section?o.colgroup:o.row,t=$o(r,e,g),l=Ts(t.cells.length,t,o,(e=>X(n,e.toString())));return Mo(t,l)})))},Rs=(e,t,o,n)=>k(e,(e=>{const r=Ts(t,e,o,v);return Wo(e,n,r)})),Ds=(e,t,o)=>{const n=t.colDelta<0?Rs:g,r=t.rowDelta<0?Ss:g,l=Uo(e),s=Fo(e[0]),a=R(l,(e=>e===s-1)),i=n(e,Math.abs(t.colDelta),o,a?s-1:s),c=Uo(i);return r(i,Math.abs(t.rowDelta),o,I(c,y))},ks=(e,t,o,n)=>{const r=b(n,Io(e[t],o).element),l=e[t];return e.length>1&&Fo(l)>1&&(o>0&&r(Po(l,o-1))||o<l.cells.length-1&&r(Po(l,o+1))||t>0&&r(Po(e[t-1],o))||t<e.length-1&&r(Po(e[t+1],o)))},Es=(e,t,o)=>A(o,(o=>o>=e.column&&o<=Fo(t[0])+e.column)),Ns=(e,t,o,n,r)=>{const l=Uo(t),s=((e,t,o)=>{const n=Fo(t[0]),r=Ho(t).cols.length+e.row,l=D(n-e.column,(t=>t+e.column)),s=z(l,(e=>M(o,(t=>t!==e)))).getOr(n-1);return{row:r,column:s}})(e,t,l),a=Ho(o).rows,i=Es(s,a,l),c=((e,t,o)=>{if(e.row>=t.length||e.column>Fo(t[0]))return ys.error("invalid start address out of table bounds, row: "+e.row+", column: "+e.column);const n=t.slice(e.row),r=n[0].cells.slice(e.column),l=Fo(o[0]),s=o.length;return ys.value({rowDelta:n.length-s,colDelta:r.length-l})})(s,t,a);return c.map((e=>{const o={...e,colDelta:e.colDelta-i.length},l=Ds(t,o,n),c=Uo(l),m=Es(s,a,c);return((e,t,o,n,r,l)=>{const s=e.row,a=e.column,i=s+o.length,c=a+Fo(o[0])+l.length,m=I(l,y);for(let d=s;d<i;d++){let e=0;for(let l=a;l<c;l++){if(m[l]){e++;continue}ks(t,d,l,r)&&bs(t,Po(t[d],l),r,n.cell);const i=l-a-e,c=Io(o[d-s],i),u=c.element,p=n.replace(u);_o(t[d],l,Ke(p,!0,c.isLocked))}}return t})(s,l,a,n,r,m)}))},As=(e,t,o,n,r)=>{((e,t,o,n)=>{t>0&&t<e[0].cells.length&&E(e,(e=>{const r=e.cells[t-1];let l=0;const s=n();for(;e.cells.length>t+l&&o(r.element,e.cells[t+l].element);)_o(e,t+l,Ke(s,!0,e.cells[t+l].isLocked)),l++}))})(t,e,r,n.cell);const l=xs(o,t),s=Ds(o,l,n),a=xs(t,s),i=Ds(t,a,n);return k(i,((t,o)=>Wo(t,e,s[o].cells)))},Bs=(e,t,o,n,r)=>{ws(t,e,r,n.cell);const l=Uo(t),s=Cs(t,o),a={...s,colDelta:s.colDelta-l.length},i=Ds(t,a,n),{cols:c,rows:m}=Ho(i),d=Uo(i),u=Cs(o,t),p={...u,colDelta:u.colDelta+d.length},f=((e,t,o)=>k(e,(e=>j(o,((o,n)=>{const r=Ts(1,e,t,y)[0];return Lo(o,n,r)}),e))))(o,n,d),g=Ds(f,p,n);return[...c,...m.slice(0,e),...g,...m.slice(e,m.length)]},js=(e,t,o,n,r)=>{const{rows:l,cols:s}=Ho(e),a=l.slice(0,t),i=l.slice(t),c=((e,t,o,n)=>$o(e,(e=>n(e,o)),t))(l[o],((e,o)=>t>0&&t<l.length&&n(Po(l[t-1],o),Po(l[t],o))?Io(l[t],o):Ke(r(e.element,n),!0,e.isLocked)),n,r);return[...s,...a,c,...i]},zs=(e,t,o,n,r)=>k(e,(e=>{const l=t>0&&t<Fo(e)&&n(Po(e,t-1),Po(e,t)),s=((e,t,o,n,r,l,s)=>{if("colgroup"!==o&&n)return Io(e,t);{const t=Io(e,r);return Ke(s(t.element,l),!0,!1)}})(e,t,e.section,l,o,n,r);return Lo(e,t,s)})),Ws=(e,t,o,n)=>((e,t,o,n)=>void 0!==Po(e[t],o)&&t>0&&n(Po(e[t-1],o),Po(e[t],o)))(e,t,o,n)||((e,t,o)=>t>0&&o(Po(e,t-1),Po(e,t)))(e[t],o,n),Ls=(e,t,o,n)=>{const r=e=>(e=>"row"===e?zt(t):jt(t))(e)?`${e}group`:e;if(e)return Ml(t)?r(o):null;if(n&&Ml(t)){return r("row"===o?"col":"row")}return null},_s=(e,t,o)=>Ke(o(e.element,t),!0,e.isLocked),Ms=(e,t,o,n,r,l,s)=>k(e,((e,a)=>((e,t)=>{const o=e.cells,n=k(o,t);return Ye(e.element,n,e.section,e.isNew)})(e,((e,i)=>{if((e=>R(t,(t=>o(e.element,t.element))))(e)){const t=s(e,a,i)?r(e,o,n):e;return l(t,a,i).each((e=>{var o,n;o=t.element,n={scope:Optional.from(e)},U(n,((e,t)=>{e.fold((()=>{pe(o,t)}),(e=>{ie(o.dom,t,e)}))}))})),t}return e})))),Is=(e,t,o)=>_(e,((n,r)=>Ws(e,r,t,o)?[]:[Io(n,t)])),Ps=(e,t,o,n,r)=>{const l=Ho(e).rows,s=_(t,(e=>Is(l,e,n))),a=k(l,(e=>Il(e.cells))),i=((e,t)=>M(t,g)&&Il(e)?y:(e,o,n)=>!("th"===Z(e.element)&&t[o]))(s,a),c=((e,t)=>(o,n)=>Optional.some(Ls(e,o.element,"row",t[n])))(o,a);return Ms(e,s,n,r,_s,c,i)},Fs=(e,t,o,n,r,l,s)=>{const{cols:a,rows:i}=Ho(e),c=i[t[0]],m=_(t,(e=>((e,t,o)=>{const n=e[t];return _(n.cells,((n,r)=>Ws(e,t,r,o)?[]:[n]))})(i,e,r))),d=k(c.cells,((e,t)=>Il(Is(i,t,r)))),u=[...i];E(t,(e=>{u[e]=s.transformRow(i[e],o)}));const p=[...a,...u],f=((e,t)=>M(t,g)&&Il(e.cells)?y:(e,o,n)=>!("th"===Z(e.element)&&t[n]))(c,d),h=((e,t)=>(o,n,r)=>Optional.some(Ls(e,o.element,"col",t[r])))(n,d);return Ms(p,m,r,l,s.transformCell,h,f)},Hs=(e,t,o,n)=>{const r=Ho(e).rows,l=k(t,(e=>Io(r[e.row],e.column)));return Ms(e,l,o,n,_s,Optional.none,y)},$s=e=>{if(!s(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");const t=[],o={};return E(e,((n,r)=>{const l=q(n);if(1!==l.length)throw new Error("one and only one name per case");const a=l[0],i=n[a];if(void 0!==o[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!s(i))throw new Error("case arguments must be an array");t.push(a),o[a]=(...o)=>{const n=o.length;if(n!==i.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+i.length+" ("+i+"), got "+n);return{fold:(...t)=>{if(t.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);return t[r].apply(null,o)},match:e=>{const n=q(e);if(t.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+n.join(","));if(!M(t,(e=>S(n,e))))throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+t.join(", "));return e[a].apply(null,o)},log:e=>{console.log(e,{constructors:t,constructor:a,params:o})}}}})),o},qs={...$s([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}])},Vs=(e,t,o,n,r)=>{const l=e.slice(0),s=((e,t)=>0===e.length?qs.none():1===e.length?qs.only(0):0===t?qs.left(0,1):t===e.length-1?qs.right(t-1,t):t>0&&t<e.length-1?qs.middle(t-1,t,t+1):qs.none())(e,t),a=f(k(l,f(0)));return s.fold(a,(e=>n.singleColumnWidth(l[e],o)),((e,t)=>r.calcLeftEdgeDeltas(l,e,t,o,n.minCellWidth(),n.isRelative)),((e,t,s)=>r.calcMiddleDeltas(l,e,t,s,o,n.minCellWidth(),n.isRelative)),((e,t)=>r.calcRightEdgeDeltas(l,e,t,o,n.minCellWidth(),n.isRelative)))},Us=(e,t,o)=>{let n=0;for(let r=e;r<t;r++)n+=void 0!==o[r]?o[r]:0;return n},Gs=(e,t)=>{const o=Jo.justCells(e);return k(o,(e=>{const o=Us(e.row,e.row+e.rowspan,t);return{element:e.element,height:o,rowspan:e.rowspan}}))},Ks=(e,t)=>Jo.hasColumns(e)?((e,t)=>{const o=Jo.justColumns(e);return k(o,((e,o)=>({element:e.element,width:t[o],colspan:e.colspan})))})(e,t):((e,t)=>{const o=Jo.justCells(e);return k(o,(e=>{const o=Us(e.column,e.column+e.colspan,t);return{element:e.element,width:o,colspan:e.colspan}}))})(e,t),Ys=(e,t,o)=>{const n=Ks(e,t);E(n,(e=>{o.setElementWidth(e.element,e.width)}))},Js=(e,t,o,n,r)=>{const l=Jo.fromTable(e),s=r.getCellDelta(t),a=r.getWidths(l,r),i=o===l.grid.columns-1,c=n.clampTableDelta(a,o,s,r.minCellWidth(),i),m=Vs(a,o,c,r,n),d=k(m,((e,t)=>e+a[t]));Ys(l,d,r),n.resizeTable(r.adjustTableWidth,c,i)},Qs=(e,t,o,n)=>{const r=Jo.fromTable(e),l=((e,t,o)=>Zn(e,t,o,Hn,(e=>e.getOrThunk(_t))))(r,e,n),s=k(l,((e,n)=>o===n?Math.max(t+e,_t()):e)),a=Gs(r,s),i=((e,t)=>k(e.all,((e,o)=>({element:e.element,height:t[o]}))))(r,s);E(i,(e=>{Wn(e.element,e.height)})),E(a,(e=>{Wn(e.element,e.height)}));const c=B(s,((e,t)=>e+t),0);Wn(e,c)},Xs=e=>j(e,((e,t)=>R(e,(e=>e.column===t.column))?e:e.concat([t])),[]).sort(((e,t)=>e.column-t.column)),Zs=ae("col"),ea=ae("colgroup"),ta=e=>"tr"===Z(e)||ea(e),oa=e=>({element:e,colspan:At(e,"colspan",1),rowspan:At(e,"rowspan",1)}),na=e=>ue(e,"scope").map((e=>e.substr(0,3))),ra=(e,t=oa)=>{const o=o=>{if(ta(o))return ea((r={element:o}).element)?e.colgroup(r):e.row(r);{const r=o,l=(t=>Zs(t.element)?e.col(t):e.cell(t))(t(r));return n=Optional.some({item:r,replacement:l}),l}var r};let n=Optional.none();return{getOrInit:(e,t)=>n.fold((()=>o(e)),(n=>t(e,n.item)?n.replacement:o(e)))}},la=e=>t=>{const o=[],n=n=>{const r="td"===e?{scope:null}:{},l=t.replace(n,e,r);return o.push({item:n,sub:l}),l};return{replaceOrInit:(e,t)=>{if(ta(e)||Zs(e))return e;{const r=e;return((e,t)=>z(o,(o=>t(o.item,e))))(r,t).fold((()=>n(r)),(o=>t(e,o.item)?o.sub:n(r)))}}}},sa=e=>({unmerge:t=>{const o=na(t);return o.each((e=>ce(t,"scope",e))),()=>{const n=e.cell({element:t,colspan:1,rowspan:1});return Nt(n,"width"),Nt(t,"width"),o.each((e=>ce(n,"scope",e))),n}},merge:e=>(Nt(e[0],"width"),(()=>{const t=gt(k(e,na));if(0===t.length)return Optional.none();{const e=t[0],o=["row","col"];return R(t,(t=>t!==e&&S(o,t)))?Optional.none():Optional.from(e)}})().fold((()=>pe(e[0],"scope")),(t=>ce(e[0],"scope",t+"group"))),f(e[0]))}),aa=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],ia=Vr(),ca=e=>((e,t)=>{const o=e.property().name(t);return S(aa,o)})(ia,e),ma=e=>((e,t)=>{const o=e.property().name(t);return S(["ol","ul"],o)})(ia,e),da=e=>((e,t)=>S(["br","img","hr","input"],e.property().name(t)))(ia,e),ua=e=>{const t=ae("br"),o=e=>br(e).bind((o=>{const n=ke(o).map((e=>!!ca(e)||!!da(e)&&"img"!==Z(e))).getOr(!1);return Se(o).map((r=>!0===n||(e=>"li"===Z(e)||ct(e,ma).isSome())(r)||t(o)||ca(r)&&!ve(e,r)?[]:[he.fromTag("br")]))})).getOr([]),n=(()=>{const n=_(e,(e=>{const n=Ee(e);return(e=>M(e,(e=>t(e)||re(e)&&0===mr(e).trim().length)))(n)?[]:n.concat(o(e))}));return 0===n.length?[he.fromTag("br")]:n})();Me(e[0]),_e(e[0],n)},pa=e=>es(e,!0),fa=e=>{0===Ft(e).length&&Ie(e)},ga=(e,t)=>({grid:e,cursor:t}),ha=(e,t,o)=>{var n,r;const l=Ho(e).rows;return Optional.from(null===(r=null===(n=l[t])||void 0===n?void 0:n.cells[o])||void 0===r?void 0:r.element).filter(pa).orThunk((()=>(e=>$(e,(e=>$(e.cells,(e=>{const t=e.element;return ht(pa(t),t)})))))(l)))},ba=(e,t,o)=>{const n=ha(e,t,o);return ga(e,n)},wa=e=>j(e,((e,t)=>R(e,(e=>e.row===t.row))?e:e.concat([t])),[]).sort(((e,t)=>e.row-t.row)),Oa=(e,t)=>(o,n,r,l,s)=>{const a=wa(n),i=k(a,(e=>e.row)),c=Fs(o,i,e,t,r,l.replaceOrInit,s);return ba(c,n[0].row,n[0].column)},va=Oa("thead",!0),ya=Oa("tbody",!1),Ca=Oa("tfoot",!1),xa=(e,t,o)=>{const n=((e,t)=>Ut(e,(()=>t)))(e,o.section),r=Jo.generate(n);return is(r,t,!0)},Ta=(e,t,o,n)=>((e,t,o,n)=>{const r=Jo.generate(t),l=n.getWidths(r,n);Ys(r,l,n)})(0,t,0,n.sizing),Sa=(e,t,o,n)=>((e,t,o,n,r)=>{const l=Jo.generate(t),s=n.getWidths(l,n),a=n.pixelWidth(),{newSizes:i,delta:c}=r.calcRedestributedWidths(s,a,o.pixelDelta,n.isRelative);Ys(l,i,n),n.adjustTableWidth(c)})(0,t,o,n.sizing,n.resize),Ra=(e,t)=>R(t,(e=>0===e.column&&e.isLocked)),Da=(e,t)=>R(t,(t=>t.column+t.colspan>=e.grid.columns&&t.isLocked)),ka=(e,t)=>{const o=Qo(e),n=Xs(t);return j(n,((e,t)=>e+o[t.column].map(Bo).getOr(0)),0)},Ea=e=>(t,o)=>fs(t,o).filter((o=>!(e?Ra:Da)(t,o))).map((e=>({details:e,pixelDelta:ka(t,e)}))),Na=e=>(t,o)=>ps(t,o).filter((o=>!(e?Ra:Da)(t,o.cells))),Aa=la("th"),Ba=la("td"),ja=us(((e,t,o,n)=>{const r=t[0].row,l=wa(t),s=B(l,((e,t)=>({grid:js(e.grid,r,t.row+e.delta,o,n.getOrInit),delta:e.delta+1})),{grid:e,delta:0}).grid;return ba(s,r,t[0].column)}),fs,p,p,ra),za=us(((e,t,o,n)=>{const r=wa(t),l=r[r.length-1],s=l.row+l.rowspan,a=B(r,((e,t)=>js(e,s,t.row,o,n.getOrInit)),e);return ba(a,s,t[0].column)}),fs,p,p,ra),Wa=us(((e,t,o,n)=>{const r=t.details,l=Xs(r),s=l[0].column,a=B(l,((e,t)=>({grid:zs(e.grid,s,t.column+e.delta,o,n.getOrInit),delta:e.delta+1})),{grid:e,delta:0}).grid;return ba(a,r[0].row,s)}),Ea(!0),Sa,p,ra),La=us(((e,t,o,n)=>{const r=t.details,l=r[r.length-1],s=l.column+l.colspan,a=Xs(r),i=B(a,((e,t)=>zs(e,s,t.column,o,n.getOrInit)),e);return ba(i,r[0].row,s)}),Ea(!1),Sa,p,ra),_a=us(((e,t,o,n)=>{const r=Xs(t.details),l=((e,t)=>_(e,(e=>{const o=e.cells,n=B(t,((e,t)=>t>=0&&t<e.length?e.slice(0,t).concat(e.slice(t+1)):e),o);return n.length>0?[Ye(e.element,n,e.section,e.isNew)]:[]})))(e,k(r,(e=>e.column))),s=l.length>0?l[0].cells.length-1:0;return ba(l,r[0].row,Math.min(r[0].column,s))}),((e,t)=>gs(e,t).map((t=>({details:t,pixelDelta:-ka(e,t)})))),Sa,fa,ra),Ma=us(((e,t,o,n)=>{const r=wa(t),l=((e,t,o)=>{const{rows:n,cols:r}=Ho(e);return[...r,...n.slice(0,t),...n.slice(o+1)]})(e,r[0].row,r[r.length-1].row),s=l.length>0?l.length-1:0;return ba(l,Math.min(t[0].row,s),t[0].column)}),fs,p,fa,ra),Ia=us(((e,t,o,n)=>{const r=Xs(t),l=k(r,(e=>e.column)),s=Ps(e,l,!0,o,n.replaceOrInit);return ba(s,t[0].row,t[0].column)}),gs,p,p,Aa),Pa=us(((e,t,o,n)=>{const r=Xs(t),l=k(r,(e=>e.column)),s=Ps(e,l,!1,o,n.replaceOrInit);return ba(s,t[0].row,t[0].column)}),gs,p,p,Ba),Fa=us(va,gs,p,p,Aa),Ha=us(ya,gs,p,p,Ba),$a=us(Ca,gs,p,p,Ba),qa=us(((e,t,o,n)=>{const r=Hs(e,t,o,n.replaceOrInit);return ba(r,t[0].row,t[0].column)}),gs,p,p,Aa),Va=us(((e,t,o,n)=>{const r=Hs(e,t,o,n.replaceOrInit);return ba(r,t[0].row,t[0].column)}),gs,p,p,Ba),Ua=us(((e,t,o,n)=>{const r=t.cells;ua(r);const l=((e,t,o,n)=>{const r=Ho(e).rows;if(0===r.length)return e;for(let l=t.startRow;l<=t.finishRow;l++)for(let e=t.startCol;e<=t.finishCol;e++){const t=r[l],o=Io(t,e).isLocked;_o(t,e,Ke(n(),!1,o))}return e})(e,t.bounds,0,n.merge(r));return ga(l,Optional.from(r[0]))}),((e,t)=>((e,t)=>t.mergable)(0,t).filter((t=>hs(e,t.cells)))),Ta,p,sa),Ga=us(((e,t,o,n)=>{const r=B(t,((e,t)=>bs(e,t,o,n.unmerge(t))),e);return ga(r,Optional.from(t[0]))}),((e,t)=>((e,t)=>t.unmergable)(0,t).filter((t=>hs(e,t)))),Ta,p,sa),Ka=us(((e,t,o,n)=>{const r=((e,t)=>{const o=Jo.fromTable(e);return is(o,t,!0)})(t.clipboard,t.generators),l=((e,t)=>({row:e,column:t}))(t.row,t.column);return Ns(l,e,r,t.generators,o).fold((()=>ga(e,Optional.some(t.element))),(e=>ba(e,t.row,t.column)))}),((e,t)=>Pt(t.element).bind((o=>ms(e,o).map((e=>({...e,generators:t.generators,clipboard:t.clipboard})))))),Ta,p,ra),Ya=us(((e,t,o,n)=>{const r=Ho(e).rows,l=t.cells[0].column,s=r[t.cells[0].row],a=xa(t.clipboard,t.generators,s),i=As(l,e,a,t.generators,o);return ba(i,t.cells[0].row,t.cells[0].column)}),Na(!0),p,p,ra),Ja=us(((e,t,o,n)=>{const r=Ho(e).rows,l=t.cells[t.cells.length-1].column+t.cells[t.cells.length-1].colspan,s=r[t.cells[0].row],a=xa(t.clipboard,t.generators,s),i=As(l,e,a,t.generators,o);return ba(i,t.cells[0].row,t.cells[0].column)}),Na(!1),p,p,ra),Qa=us(((e,t,o,n)=>{const r=Ho(e).rows,l=t.cells[0].row,s=r[l],a=xa(t.clipboard,t.generators,s),i=Bs(l,e,a,t.generators,o);return ba(i,t.cells[0].row,t.cells[0].column)}),ps,p,p,ra),Xa=us(((e,t,o,n)=>{const r=Ho(e).rows,l=t.cells[t.cells.length-1].row+t.cells[t.cells.length-1].rowspan,s=r[t.cells[0].row],a=xa(t.clipboard,t.generators,s),i=Bs(l,e,a,t.generators,o);return ba(i,t.cells[0].row,t.cells[0].column)}),ps,p,p,ra),Za=(e,t)=>{const o=Jo.fromTable(e);return fs(o,t).bind((e=>{const t=e[e.length-1],n=e[0].column,r=t.column+t.colspan,l=L(k(o.all,(e=>A(e.cells,(e=>e.column>=n&&e.column<r)))));return Hl(l)})).getOr("")},ei=(e,t)=>{const o=Jo.fromTable(e);return fs(o,t).bind(Hl).getOr("")},ti=(e,t)=>{const o=Jo.fromTable(e);return fs(o,t).bind((e=>{const t=e[e.length-1],n=e[0].row,r=t.row+t.rowspan;return(e=>{const t=k(e,(e=>Fl(e).type)),o=S(t,"header"),n=S(t,"footer");if(o||n){const e=S(t,"body");return!o||e||n?o||e||!n?Optional.none():Optional.some("footer"):Optional.some("header")}return Optional.some("body")})(o.all.slice(n,r))})).getOr("")},oi=(e,t)=>e.dispatch("NewRow",{node:t}),ni=(e,t)=>e.dispatch("NewCell",{node:t}),ri=(e,t,o)=>{e.dispatch("TableModified",{...o,table:t})},li={structure:!1,style:!0},si={structure:!0,style:!1},ai={structure:!0,style:!0},ii=e=>t=>t.options.get(e),ci="100%",mi=e=>{var t;const o=e.dom,n=null!==(t=o.getParent(e.selection.getStart(),o.isBlock))&&void 0!==t?t:e.getBody();return jo(he.fromDom(n))+"px"},di=e=>Optional.from(e.options.get("table_clone_elements")),ui=ii("table_header_type"),pi=ii("table_column_resizing"),fi=e=>"preservetable"===pi(e),gi=e=>"resizetable"===pi(e),hi=ii("table_sizing_mode"),bi=e=>"relative"===hi(e),wi=e=>"fixed"===hi(e),Oi=e=>"responsive"===hi(e),vi=ii("table_resize_bars"),yi=ii("table_style_by_css"),Ci=e=>{const t=e.options,o=t.get("table_default_attributes");return t.isSet("table_default_attributes")?o:((e,t)=>Oi(e)||yi(e)?t:wi(e)?{...t,width:mi(e)}:{...t,width:ci})(e,o)},xi=e=>{const t=e.options,o=t.get("table_default_styles");return t.isSet("table_default_styles")?o:((e,t)=>Oi(e)||!yi(e)?t:wi(e)?{...t,width:mi(e)}:{...t,width:ci})(e,o)},Ti=ii("table_use_colgroups"),Si=(e,t)=>bi(e)?sr(t):wi(e)?lr(t):rr(t),Ri=(e,t,o)=>{const n=e=>"table"===Z(kr(e)),r=di(e),l=gi(e)?p:El,s=t=>{switch(ui(e)){case"section":return Yl();case"sectionCells":return Jl();case"cells":return Ql();default:return Kl(t,"section")}},a=(t,n)=>n.cursor.fold((()=>{const n=Ft(t);return F(n).filter(ot).map((n=>{o.clearSelectedCells(t.dom);const r=e.dom.createRng();return r.selectNode(n.dom),e.selection.setRng(r),ce(n,"data-mce-selected","1"),r}))}),(n=>{const r=Dl(kl,n);const l=e.dom.createRng();return l.setStart(r.element.dom,r.offset),l.setEnd(r.element.dom,r.offset),e.selection.setRng(l),o.clearSelectedCells(t.dom),Optional.some(l)})),i=(o,n,l,i)=>(c,m,d=!1)=>{Nr(c);const u=he.fromDom(e.getDoc()),p=Rr(l,u,r),f={sizing:Si(e,c),resize:gi(e)?Wl():Ll(),section:s(c)};return n(c)?o(c,m,p,f).bind((o=>{t.refresh(c.dom),E(o.newRows,(t=>{oi(e,t.dom)})),E(o.newCells,(t=>{ni(e,t.dom)}));const n=a(c,o);return ot(c)&&(Nr(c),d||ri(e,c.dom,i)),n.map((e=>({rng:e,effect:i})))})):Optional.none()},c=i(Ma,(t=>!n(e)||_l(t).rows>1),p,si),m=i(_a,(t=>!n(e)||_l(t).columns>1),p,si);return{deleteRow:c,deleteColumn:m,insertRowsBefore:i(ja,y,p,si),insertRowsAfter:i(za,y,p,si),insertColumnsBefore:i(Wa,y,l,si),insertColumnsAfter:i(La,y,l,si),mergeCells:i(Ua,y,p,si),unmergeCells:i(Ga,y,p,si),pasteColsBefore:i(Ya,y,p,si),pasteColsAfter:i(Ja,y,p,si),pasteRowsBefore:i(Qa,y,p,si),pasteRowsAfter:i(Xa,y,p,si),pasteCells:i(Ka,y,p,ai),makeCellsHeader:i(qa,y,p,si),unmakeCellsHeader:i(Va,y,p,si),makeColumnsHeader:i(Ia,y,p,si),unmakeColumnsHeader:i(Pa,y,p,si),makeRowsHeader:i(Fa,y,p,si),makeRowsBody:i(Ha,y,p,si),makeRowsFooter:i($a,y,p,si),getTableRowType:ti,getTableCellType:ei,getTableColType:Za}},Di=(e,t,o)=>{const n=At(e,t,1);1===o||n<=1?pe(e,t):ce(e,t,Math.min(o,n))},ki=(e,t)=>o=>{const n=o.column+o.colspan-1,r=o.column;return n>=e&&r<t},Ei=(e,t)=>{const o=Jo.fromTable(e);return gs(o,t).map((e=>{const t=e[e.length-1],n=e[0].column,r=t.column+t.colspan,l=((e,t,o)=>{if(Jo.hasColumns(e)){const n=A(Jo.justColumns(e),ki(t,o)),r=k(n,(e=>{const n=$e(e.element);return Di(n,"span",o-t),n})),l=he.fromTag("colgroup");return _e(l,r),[l]}return[]})(o,n,r),s=((e,t,o)=>k(e.all,(e=>{const n=A(e.cells,ki(t,o)),r=k(n,(e=>{const n=$e(e.element);return Di(n,"colspan",o-t),n})),l=he.fromTag("tr");return _e(l,r),l})))(o,n,r);return[...l,...s]}))},Ni=(e,t,o)=>{const n=Jo.fromTable(e);return fs(n,t).bind((e=>{const t=is(n,o,!1),r=Ho(t).rows.slice(e[0].row,e[e.length-1].row+e[e.length-1].rowspan),l=_(r,(e=>{const t=A(e.cells,(e=>!e.isLocked));return t.length>0?[{...e,cells:t}]:[]})),s=cs(l);return ht(s.length>0,s)})).map((e=>(e=>k(e,(e=>{const t=He(e.element);return E(e.cells,(e=>{const o=$e(e.element);os(o,"colspan",e.colspan,1),os(o,"rowspan",e.rowspan,1),ze(t,o)})),t})))(e)))},Ai=$s([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),Bi=(e,t,o)=>{const n=o.substring(0,o.length-e.length),r=parseFloat(n);return n===r.toString()?t(r):Ai.invalid(o)},ji={...Ai,from:e=>vt(e,"%")?Bi("%",Ai.percent,e):vt(e,"px")?Bi("px",Ai.pixels,e):Ai.invalid(e)},zi=(e,t,o)=>e.fold((()=>t),(e=>((e,t,o)=>{const n=o/t;return k(e,(e=>ji.from(e).fold((()=>e),(e=>e*n+"px"),(e=>e/100*o+"px"))))})(t,o,e)),(e=>((e,t)=>k(e,(e=>ji.from(e).fold((()=>e),(e=>e/t*100+"%"),(e=>e+"%")))))(t,o))),Wi=(e,t,o)=>{const n=ji.from(o),r=M(e,(e=>"0px"===e))?((e,t)=>{const o=e.fold((()=>f("")),(e=>f(e/t+"px")),(()=>f(100/t+"%")));return D(t,o)})(n,e.length):zi(n,e,t);return Mi(r)},Li=(e,t)=>0===e.length?t:B(e,((e,t)=>ji.from(t).fold(f(0),g,g)+e),0),_i=(e,t)=>ji.from(e).fold(f(e),(e=>e+t+"px"),(e=>e+t+"%")),Mi=e=>{if(0===e.length)return e;const t=B(e,((e,t)=>{const o=ji.from(t).fold((()=>({value:t,remainder:0})),(e=>((e,t)=>{const o=Math.floor(e);return{value:o+t,remainder:e-o}})(e,"px")),(e=>({value:e+"%",remainder:0})));return{output:[o.value].concat(e.output),remainder:e.remainder+o.remainder}}),{output:[],remainder:0}),o=t.output;return o.slice(0,o.length-1).concat([_i(o[o.length-1],Math.round(t.remainder))])},Ii=ji.from,Pi=e=>Ii(e).fold(f("px"),f("px"),f("%")),Fi=(e,t,o)=>{const n=Jo.fromTable(e),r=n.all,l=Jo.justCells(n),s=Jo.justColumns(n);t.each((t=>{const o=Pi(t),r=Ao(e),a=((e,t)=>Jn(e,t,Gn,Qn))(n,e),i=Wi(a,r,t);Jo.hasColumns(n)?((e,t,o)=>{E(t,((t,n)=>{const r=Li([e[n]],Lt());St(t.element,"width",r+o)}))})(i,s,o):((e,t,o)=>{E(t,(t=>{const n=e.slice(t.column,t.colspan+t.column),r=Li(n,Lt());St(t.element,"width",r+o)}))})(i,l,o),St(e,"width",t)})),o.each((t=>{const o=Pi(t),s=rn(e),a=((e,t,o)=>Zn(e,t,o,Kn,Qn))(n,e,xn);((e,t,o,n)=>{E(o,(t=>{const o=e.slice(t.row,t.rowspan+t.row),r=Li(o,_t());St(t.element,"height",r+n)})),E(t,((t,o)=>{St(t.element,"height",e[o])}))})(Wi(a,s,t),r,l,o),St(e,"height",t)}))},Hi=e=>In(e).exists((e=>En.test(e))),$i=e=>In(e).exists((e=>Nn.test(e))),qi=e=>In(e).isNone(),Vi=e=>{pe(e,"width")},Ui=e=>{const t=qn(e);Fi(e,Optional.some(t),Optional.none()),Vi(e)},Gi=e=>{const t=(e=>Ao(e)+"px")(e);Fi(e,Optional.some(t),Optional.none()),Vi(e)},Ki=e=>{Nt(e,"width");const t=Ht(e),o=t.length>0?t:Ft(e);E(o,(e=>{Nt(e,"width"),Vi(e)})),Vi(e)},Yi={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},Ji=e=>{const t=he.fromTag("colgroup");return D(e,(()=>ze(t,he.fromTag("col")))),t},Qi=(e,t,o,n)=>D(e,(e=>((e,t,o,n)=>{const r=he.fromTag("tr");for(let l=0;l<e;l++){const e=n<t||l<o?he.fromTag("th"):he.fromTag("td");l<o&&ce(e,"scope","row"),n<t&&ce(e,"scope","col"),ze(e,he.fromTag("br")),ze(r,e)}return r})(t,o,n,e))),Xi=(e,t)=>{e.selection.select(t.dom,!0),e.selection.collapse(!0)},Zi=(e,t,o,n,l)=>{const s=xi(e),a={styles:s,attributes:Ci(e),colGroups:Ti(e)};return e.undoManager.ignore((()=>{const r=((e,t,o,n,r,l=Yi)=>{const s=he.fromTag("table"),a="cells"!==r;Rt(s,l.styles),me(s,l.attributes),l.colGroups&&ze(s,Ji(t));const i=Math.min(e,o);if(a&&o>0){const e=he.fromTag("thead");ze(s,e);const l=Qi(o,t,"sectionCells"===r?i:0,n);_e(e,l)}const c=he.fromTag("tbody");ze(s,c);const m=Qi(a?e-i:e,t,a?0:o,n);return _e(c,m),s})(o,t,l,n,ui(e),a);ce(r,"data-mce-id","__mce");const s=(e=>{const t=he.fromTag("div"),o=he.fromDom(e.dom.cloneNode(!0));return ze(t,o),(e=>e.dom.innerHTML)(t)})(r);e.insertContent(s),e.addVisual()})),ut(kr(e),'table[data-mce-id="__mce"]').map((t=>(wi(e)?Gi(t):Oi(e)?Ki(t):(bi(e)||(e=>r(e)&&-1!==e.indexOf("%"))(s.width))&&Ui(t),Nr(t),pe(t,"data-mce-id"),((e,t)=>{E(at(t,"tr"),(t=>{oi(e,t.dom),E(at(t,"th,td"),(t=>{ni(e,t.dom)}))}))})(e,t),((e,t)=>{ut(t,"td,th").each(b(Xi,e))})(e,t),t.dom))).getOrNull()};var ec=tinymce.util.Tools.resolve("tinymce.FakeClipboard");const tc="x-tinymce/dom-table-",oc=tc+"rows",nc=tc+"columns",rc=e=>{const t=ec.FakeClipboardItem(e);ec.write([t])},lc=e=>{var t;const o=null!==(t=ec.read())&&void 0!==t?t:[];return $(o,(t=>Optional.from(t.getType(e))))},sc=e=>{lc(e).isSome()&&ec.clear()},ac=e=>{e.fold(cc,(e=>rc({[oc]:e})))},ic=()=>lc(oc),cc=()=>sc(oc),mc=e=>{e.fold(uc,(e=>rc({[nc]:e})))},dc=()=>lc(nc),uc=()=>sc(nc),pc=e=>Ol(Ar(e),Er(e)),fc=(e,t)=>{const o=Er(e),n=e=>$t(e,o),s=t=>(e=>vl(Ar(e),Er(e)))(e).bind((e=>n(e).map((o=>t(o,e))))),a=t=>{e.focus()},i=(t,o=!1)=>s(((n,r)=>{const l=bl(yl(e),n,r);t(n,l,o).each(a)})),c=()=>s(((t,o)=>{const n=bl(yl(e),t,o),r=Rr(p,he.fromDom(e.getDoc()),Optional.none());return Ni(t,n,r)})),m=()=>s(((t,o)=>{const n=bl(yl(e),t,o);return Ei(t,n)})),d=(t,o)=>o().each((o=>{const n=k(o,(e=>$e(e)));s(((o,r)=>{const l=Dr(he.fromDom(e.getDoc())),s=((e,t,o,n)=>({selection:ll(e),clipboard:o,generators:n}))(yl(e),0,n,l);t(o,s).each(a)}))})),f=e=>(t,o)=>((e,t)=>X(e,t)?Optional.from(e[t]):Optional.none())(o,"type").each((t=>{i(e(t),o.no_events)}));U({mceTableSplitCells:()=>i(t.unmergeCells),mceTableMergeCells:()=>i(t.mergeCells),mceTableInsertRowBefore:()=>i(t.insertRowsBefore),mceTableInsertRowAfter:()=>i(t.insertRowsAfter),mceTableInsertColBefore:()=>i(t.insertColumnsBefore),mceTableInsertColAfter:()=>i(t.insertColumnsAfter),mceTableDeleteCol:()=>i(t.deleteColumn),mceTableDeleteRow:()=>i(t.deleteRow),mceTableCutCol:()=>m().each((e=>{mc(e),i(t.deleteColumn)})),mceTableCutRow:()=>c().each((e=>{ac(e),i(t.deleteRow)})),mceTableCopyCol:()=>m().each((e=>mc(e))),mceTableCopyRow:()=>c().each((e=>ac(e))),mceTablePasteColBefore:()=>d(t.pasteColsBefore,dc),mceTablePasteColAfter:()=>d(t.pasteColsAfter,dc),mceTablePasteRowBefore:()=>d(t.pasteRowsBefore,ic),mceTablePasteRowAfter:()=>d(t.pasteRowsAfter,ic),mceTableDelete:()=>pc(e).each((t=>{$t(t,o).filter(w(o)).each((t=>{const o=he.fromText("");if(Be(t,o),Ie(t),e.dom.isEmpty(e.getBody()))e.setContent(""),e.selection.setCursorLocation();else{const t=e.dom.createRng();t.setStart(o.dom,0),t.setEnd(o.dom,0),e.selection.setRng(t),e.nodeChanged()}}))})),mceTableCellToggleClass:(t,o)=>{s((t=>{const n=yl(e),r=M(n,(t=>e.formatter.match("tablecellclass",{value:o},t.dom))),l=r?e.formatter.remove:e.formatter.apply;E(n,(e=>l("tablecellclass",{value:o},e.dom))),ri(e,t.dom,li)}))},mceTableToggleClass:(t,o)=>{s((t=>{e.formatter.toggle("tableclass",{value:o},t.dom),ri(e,t.dom,li)}))},mceTableToggleCaption:()=>{pc(e).each((t=>{$t(t,o).each((o=>{dt(o,"caption").fold((()=>{const t=he.fromTag("caption");ze(t,he.fromText("Caption")),((e,t,o)=>{Ne(e,o).fold((()=>{ze(e,t)}),(e=>{Ae(e,t)}))})(o,t,0),e.selection.setCursorLocation(t.dom,0)}),(n=>{ae("caption")(t)&&Oe("td",o).each((t=>e.selection.setCursorLocation(t.dom,0))),Ie(n)})),ri(e,o.dom,si)}))}))},mceTableSizingMode:(t,n)=>(t=>pc(e).each((n=>{Oi(e)||wi(e)||bi(e)||$t(n,o).each((o=>{"relative"!==t||Hi(o)?"fixed"!==t||$i(o)?"responsive"!==t||qi(o)||Ki(o):Gi(o):Ui(o),Nr(o),ri(e,o.dom,si)}))})))(n),mceTableCellType:f((e=>"th"===e?t.makeCellsHeader:t.unmakeCellsHeader)),mceTableColType:f((e=>"th"===e?t.makeColumnsHeader:t.unmakeColumnsHeader)),mceTableRowType:f((e=>{switch(e){case"header":return t.makeRowsHeader;case"footer":return t.makeRowsFooter;default:return t.makeRowsBody}}))},((t,o)=>e.addCommand(o,t))),e.addCommand("mceInsertTable",((t,o)=>{((e,t,o,n={})=>{const r=e=>u(e)&&e>0;if(r(t)&&r(o)){const r=n.headerRows||0,l=n.headerColumns||0;return Zi(e,o,t,l,r)}console.error("Invalid values for mceInsertTable - rows and columns values are required to insert a table.")})(e,o.rows,o.columns,o.options)})),e.addCommand("mceTableApplyCellStyle",((t,o)=>{const s=e=>"tablecell"+e.toLowerCase().replace("-","");if(!l(o))return;const a=yl(e);if(0===a.length)return;const i=Y(o,((t,o)=>e.formatter.has(s(o))&&r(t)));(e=>{for(const t in e)if(V.call(e,t))return!1;return!0})(i)||(U(i,((t,o)=>{const n=s(o);E(a,(o=>{""===t?e.formatter.remove(n,{value:null},o.dom,!0):e.formatter.apply(n,{value:t},o.dom)}))})),n(a[0]).each((t=>ri(e,t.dom,li))))}))},gc=$s([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),hc={before:gc.before,on:gc.on,after:gc.after,cata:(e,t,o,n)=>e.fold(t,o,n),getStart:e=>e.fold(g,g,g)},bc=(e,t)=>({selection:e,kill:t}),wc=(e,t)=>{const o=e.document.createRange();return o.selectNode(t.dom),o},Oc=(e,t)=>{const o=e.document.createRange();return vc(o,t),o},vc=(e,t)=>e.selectNodeContents(t.dom),yc=(e,t,o)=>{const n=e.document.createRange();var r;return r=n,t.fold((e=>{r.setStartBefore(e.dom)}),((e,t)=>{r.setStart(e.dom,t)}),(e=>{r.setStartAfter(e.dom)})),((e,t)=>{t.fold((t=>{e.setEndBefore(t.dom)}),((t,o)=>{e.setEnd(t.dom,o)}),(t=>{e.setEndAfter(t.dom)}))})(n,o),n},Cc=(e,t,o,n,r)=>{const l=e.document.createRange();return l.setStart(t.dom,o),l.setEnd(n.dom,r),l},xc=e=>({left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}),Tc=$s([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Sc=(e,t,o)=>t(he.fromDom(o.startContainer),o.startOffset,he.fromDom(o.endContainer),o.endOffset),Rc=(e,t)=>{const o=((e,t)=>t.match({domRange:e=>({ltr:f(e),rtl:Optional.none}),relative:(t,o)=>({ltr:Yt((()=>yc(e,t,o))),rtl:Yt((()=>Optional.some(yc(e,o,t))))}),exact:(t,o,n,r)=>({ltr:Yt((()=>Cc(e,t,o,n,r))),rtl:Yt((()=>Optional.some(Cc(e,n,r,t,o))))})}))(e,t);return((e,t)=>{const o=t.ltr();if(o.collapsed)return t.rtl().filter((e=>!1===e.collapsed)).map((e=>Tc.rtl(he.fromDom(e.endContainer),e.endOffset,he.fromDom(e.startContainer),e.startOffset))).getOrThunk((()=>Sc(0,Tc.ltr,o)));return Sc(0,Tc.ltr,o)})(0,o)},Dc=(e,t)=>Rc(e,t).match({ltr:(t,o,n,r)=>{const l=e.document.createRange();return l.setStart(t.dom,o),l.setEnd(n.dom,r),l},rtl:(t,o,n,r)=>{const l=e.document.createRange();return l.setStart(n.dom,r),l.setEnd(t.dom,o),l}});Tc.ltr,Tc.rtl;const kc=(e,t,o,n)=>({start:e,soffset:t,finish:o,foffset:n}),Ec=(e,t,o,n)=>({start:hc.on(e,t),finish:hc.on(o,n)}),Nc=(e,t)=>{const o=Dc(e,t);return kc(he.fromDom(o.startContainer),o.startOffset,he.fromDom(o.endContainer),o.endOffset)},Ac=Ec,Bc=(e,t,o,n,r)=>ve(o,n)?Optional.none():Zr(o,n,t).bind((t=>{const n=t.boxes.getOr([]);return n.length>1?(r(e,n,t.start,t.finish),Optional.some(bc(Optional.some(Ac(o,0,o,pr(o))),!0))):Optional.none()})),jc=(e,t)=>({item:e,mode:t}),zc=(e,t,o,n=Wc)=>e.property().parent(t).map((e=>jc(e,n))),Wc=(e,t,o,n=Lc)=>o.sibling(e,t).map((e=>jc(e,n))),Lc=(e,t,o,n=Lc)=>{const r=e.property().children(t);return o.first(r).map((e=>jc(e,n)))},_c=[{current:zc,next:Wc,fallback:Optional.none()},{current:Wc,next:Lc,fallback:Optional.some(zc)},{current:Lc,next:Lc,fallback:Optional.some(Wc)}],Mc=(e,t,o,n,r=_c)=>z(r,(e=>e.current===o)).bind((o=>o.current(e,t,n,o.next).orThunk((()=>o.fallback.bind((o=>Mc(e,t,o,n))))))),Ic=()=>({sibling:(e,t)=>e.query().prevSibling(t),first:e=>e.length>0?Optional.some(e[e.length-1]):Optional.none()}),Pc=()=>({sibling:(e,t)=>e.query().nextSibling(t),first:e=>e.length>0?Optional.some(e[0]):Optional.none()}),Fc=(e,t,o,n,r,l)=>Mc(e,t,n,r).bind((t=>l(t.item)?Optional.none():o(t.item)?Optional.some(t.item):Fc(e,t.item,o,t.mode,r,l))),Hc=e=>t=>0===e.property().children(t).length,$c=(e,t,o,n)=>Fc(e,t,o,Wc,Ic(),n),qc=(e,t,o,n)=>Fc(e,t,o,Wc,Pc(),n),Vc=Vr(),Uc=(e,t)=>((e,t,o)=>$c(e,t,Hc(e),o))(Vc,e,t),Gc=(e,t)=>((e,t,o)=>qc(e,t,Hc(e),o))(Vc,e,t),Kc=$s([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),Yc=e=>pt(e,"tr"),Jc={...Kc,verify:(e,t,o,n,r,l,s)=>pt(n,"td,th",s).bind((o=>pt(t,"td,th",s).map((t=>ve(o,t)?ve(n,o)&&pr(o)===r?l(t):Kc.none("in same cell"):Qr(Yc,[o,t]).fold((()=>((e,t,o)=>{const n=e.getRect(t),r=e.getRect(o);return r.right>n.left&&r.left<n.right})(e,t,o)?Kc.success():l(t)),(e=>l(t))))))).getOr(Kc.none("default")),cata:(e,t,o,n,r)=>e.fold(t,o,n,r)},Qc=(e,t)=>W(e,b(ve,t)),Xc=ae("br"),Zc=(e,t,o)=>t(e,o).bind((e=>re(e)&&0===mr(e).trim().length?Zc(e,t,o):Optional.some(e))),em=(e,t,o,n)=>((e,t)=>Ne(e,t).filter(Xc).orThunk((()=>Ne(e,t-1).filter(Xc))))(t,o).bind((t=>n.traverse(t).fold((()=>Zc(t,n.gather,e).map(n.relative)),(e=>(e=>Se(e).bind((t=>{const o=Ee(t);return Qc(o,e).map((n=>((e,t,o,n)=>({parent:e,children:t,element:o,index:n}))(t,o,e,n)))})))(e).map((e=>hc.on(e.parent,e.index))))))),tm=(e,t,o,n)=>{const r=Xc(t)?((e,t,o)=>o.traverse(t).orThunk((()=>Zc(t,o.gather,e))).map(o.relative))(e,t,n):em(e,t,o,n);return r.map((e=>({start:e,finish:e})))},om=(e,t)=>({left:e.left,top:e.top+t,right:e.right,bottom:e.bottom+t}),nm=(e,t)=>({left:e.left,top:e.top-t,right:e.right,bottom:e.bottom-t}),rm=(e,t,o)=>({left:e.left+t,top:e.top+o,right:e.right+t,bottom:e.bottom+o}),lm=e=>({left:e.left,top:e.top,right:e.right,bottom:e.bottom}),sm=(e,t)=>Optional.some(e.getRect(t)),am=(e,t,o)=>ne(t)?sm(e,t).map(lm):re(t)?((e,t,o)=>o>=0&&o<pr(t)?e.getRangedRect(t,o,t,o+1):o>0?e.getRangedRect(t,o-1,t,o):Optional.none())(e,t,o).map(lm):Optional.none(),im=(e,t)=>ne(t)?sm(e,t).map(lm):re(t)?e.getRangedRect(t,0,t,pr(t)).map(lm):Optional.none(),cm=$s([{none:[]},{retry:["caret"]}]),mm=(e,t,o)=>{return(n=t,r=ca,it(((e,t)=>t(e)),ct,n,r,l)).fold(v,(t=>im(e,t).exists((e=>((e,t)=>e.left<t.left||Math.abs(t.right-e.left)<1||e.left>t.right)(o,e)))));var n,r,l},dm={point:e=>e.bottom,adjuster:(e,t,o,n,r)=>{const l=om(r,5);return Math.abs(o.bottom-n.bottom)<1||o.top>r.bottom?cm.retry(l):o.top===r.bottom?cm.retry(om(r,1)):mm(e,t,r)?cm.retry(rm(l,5,0)):cm.none()},move:om,gather:Gc},um=(e,t,o,n,r)=>0===r?Optional.some(n):((e,t,o)=>e.elementFromPoint(t,o).filter((e=>"table"===Z(e))).isSome())(e,n.left,t.point(n))?((e,t,o,n,r)=>um(e,t,o,t.move(n,5),r))(e,t,o,n,r-1):e.situsFromPoint(n.left,t.point(n)).bind((l=>l.start.fold(Optional.none,(l=>im(e,l).bind((s=>t.adjuster(e,l,s,o,n).fold(Optional.none,(n=>um(e,t,o,n,r-1))))).orThunk((()=>Optional.some(n)))),Optional.none))),pm=(e,t,o)=>{const n=e.move(o,5),r=um(t,e,o,n,100).getOr(n);return((e,t,o)=>e.point(t)>o.getInnerHeight()?Optional.some(e.point(t)-o.getInnerHeight()):e.point(t)<0?Optional.some(-e.point(t)):Optional.none())(e,r,t).fold((()=>t.situsFromPoint(r.left,e.point(r))),(o=>(t.scrollBy(0,o),t.situsFromPoint(r.left,e.point(r)-o))))},fm={tryUp:b(pm,{point:e=>e.top,adjuster:(e,t,o,n,r)=>{const l=nm(r,5);return Math.abs(o.top-n.top)<1||o.bottom<r.top?cm.retry(l):o.bottom===r.top?cm.retry(nm(r,1)):mm(e,t,r)?cm.retry(rm(l,5,0)):cm.none()},move:nm,gather:Uc}),tryDown:b(pm,dm),getJumpSize:f(5)},gm=(e,t,o)=>e.getSelection().bind((n=>tm(t,n.finish,n.foffset,o).fold((()=>Optional.some(xl(n.finish,n.foffset))),(r=>{const l=e.fromSitus(r);return(e=>Jc.cata(e,(e=>Optional.none()),(()=>Optional.none()),(e=>Optional.some(xl(e,0))),(e=>Optional.some(xl(e,pr(e))))))(Jc.verify(e,n.finish,n.foffset,l.finish,l.foffset,o.failure,t))})))),hm=(e,t,o,n,r,l)=>0===l?Optional.none():Om(e,t,o,n,r).bind((s=>{const a=e.fromSitus(s),i=Jc.verify(e,o,n,a.finish,a.foffset,r.failure,t);return Jc.cata(i,(()=>Optional.none()),(()=>Optional.some(s)),(s=>ve(o,s)&&0===n?bm(e,o,n,nm,r):hm(e,t,s,0,r,l-1)),(s=>ve(o,s)&&n===pr(s)?bm(e,o,n,om,r):hm(e,t,s,pr(s),r,l-1)))})),bm=(e,t,o,n,r)=>am(e,t,o).bind((t=>wm(e,r,n(t,fm.getJumpSize())))),wm=(e,t,o)=>{const n=So().browser;return n.isChromium()||n.isSafari()||n.isFirefox()?t.retry(e,o):Optional.none()},Om=(e,t,o,n,r)=>am(e,o,n).bind((t=>wm(e,r,t))),vm=(e,t)=>{return ct(e,(e=>Se(e).exists((e=>ve(e,t)))),o).isSome();var o},ym=(e,t,o,n,r)=>pt(n,"td,th",t).bind((n=>pt(n,"table",t).bind((l=>vm(r,l)?((e,t,o)=>gm(e,t,o).bind((n=>hm(e,t,n.element,n.offset,o,20).map(e.fromSitus))))(e,t,o).bind((e=>pt(e.finish,"td,th",t).map((t=>({start:n,finish:t,range:e}))))):Optional.none())))),Cm=(e,t,o,n,r,l)=>l(n,t).orThunk((()=>ym(e,t,o,n,r).map((e=>{const t=e.range;return bc(Optional.some(Ac(t.start,t.soffset,t.finish,t.foffset)),!0)})))),xm=(e,t)=>pt(e,"tr",t).bind((e=>pt(e,"table",t).bind((o=>{const n=at(o,"tr");return ve(e,n[0])?((e,t,o)=>$c(Vc,e,t,o))(o,(e=>br(e).isSome()),t).map((e=>{const t=pr(e);return bc(Optional.some(Ac(e,t,e,t)),!0)})):Optional.none()})))),Tm=(e,t)=>pt(e,"tr",t).bind((e=>pt(e,"table",t).bind((o=>{const n=at(o,"tr");return ve(e,n[n.length-1])?((e,t,o)=>qc(Vc,e,t,o))(o,(e=>hr(e).isSome()),t).map((e=>bc(Optional.some(Ac(e,0,e,0)),!0))):Optional.none()})))),Sm=(e,t,o,n,r,l,s)=>ym(e,o,n,r,l).bind((e=>Bc(t,o,e.start,e.finish,s))),Rm=e=>{let t=e;return{get:()=>t,set:e=>{t=e}}},Dm=()=>{const e=(e=>{const t=Rm(Optional.none()),o=()=>t.get().each(e);return{clear:()=>{o(),t.set(Optional.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:e=>{o(),t.set(Optional.some(e))}}})(p);return{...e,on:t=>e.get().each(t)}},km=(e,t)=>pt(e,"td,th",t),Em={traverse:ke,gather:Gc,relative:hc.before,retry:fm.tryDown,failure:Jc.failedDown},Nm={traverse:De,gather:Uc,relative:hc.before,retry:fm.tryUp,failure:Jc.failedUp},Am=e=>t=>t===e,Bm=Am(38),jm=Am(40),zm=e=>e>=37&&e<=40,Wm={isBackward:Am(37),isForward:Am(39)},Lm={isBackward:Am(39),isForward:Am(37)},_m=$s([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Mm={domRange:_m.domRange,relative:_m.relative,exact:_m.exact,exactFromRange:e=>_m.exact(e.start,e.soffset,e.finish,e.foffset),getWin:e=>{const t=(e=>e.match({domRange:e=>he.fromDom(e.startContainer),relative:(e,t)=>hc.getStart(e),exact:(e,t,o,n)=>e}))(e);return o=t,he.fromDom(Te(o).dom.defaultView);var o},range:kc},Im=(e,t,o)=>{var n,r;return Optional.from(null===(r=(n=e.dom).caretPositionFromPoint)||void 0===r?void 0:r.call(n,t,o)).bind((t=>{if(null===t.offsetNode)return Optional.none();const o=e.dom.createRange();return o.setStart(t.offsetNode,t.offset),o.collapse(),Optional.some(o)}))},Pm=(e,t,o)=>{var n,r;return Optional.from(null===(r=(n=e.dom).caretRangeFromPoint)||void 0===r?void 0:r.call(n,t,o))},Fm=document.caretPositionFromPoint?Im:document.caretRangeFromPoint?Pm:Optional.none,Hm=(e,t)=>{const o=Z(e);return"input"===o?hc.after(e):S(["br","img"],o)?0===t?hc.before(e):hc.after(e):hc.on(e,t)},$m=(e,t,o,n)=>{const r=((e,t,o,n)=>{const r=xe(e).dom.createRange();return r.setStart(e.dom,t),r.setEnd(o.dom,n),r})(e,t,o,n),l=ve(e,o)&&t===n;return r.collapsed&&!l},qm=e=>Optional.from(e.getSelection()),Vm=(e,t)=>{qm(e).each((e=>{e.removeAllRanges(),e.addRange(t)}))},Um=(e,t,o,n,r)=>{const l=Cc(e,t,o,n,r);Vm(e,l)},Gm=(e,t)=>Rc(e,t).match({ltr:(t,o,n,r)=>{Um(e,t,o,n,r)},rtl:(t,o,n,r)=>{qm(e).each((l=>{if(l.setBaseAndExtent)l.setBaseAndExtent(t.dom,o,n.dom,r);else if(l.extend)try{((e,t,o,n,r,l)=>{t.collapse(o.dom,n),t.extend(r.dom,l)})(0,l,t,o,n,r)}catch(s){Um(e,n,r,t,o)}else Um(e,n,r,t,o)}))}}),Km=(e,t,o,n,r)=>{const l=((e,t,o,n)=>{const r=Hm(e,t),l=Hm(o,n);return Mm.relative(r,l)})(t,o,n,r);Gm(e,l)},Ym=(e,t,o)=>{const n=((e,t)=>{const o=e.fold(hc.before,Hm,hc.after),n=t.fold(hc.before,Hm,hc.after);return Mm.relative(o,n)})(t,o);Gm(e,n)},Jm=e=>{if(e.rangeCount>0){const t=e.getRangeAt(0),o=e.getRangeAt(e.rangeCount-1);return Optional.some(kc(he.fromDom(t.startContainer),t.startOffset,he.fromDom(o.endContainer),o.endOffset))}return Optional.none()},Qm=e=>{if(null===e.anchorNode||null===e.focusNode)return Jm(e);{const t=he.fromDom(e.anchorNode),o=he.fromDom(e.focusNode);return $m(t,e.anchorOffset,o,e.focusOffset)?Optional.some(kc(t,e.anchorOffset,o,e.focusOffset)):Jm(e)}},Xm=(e,t,o=!0)=>{const n=(o?Oc:wc)(e,t);Vm(e,n)},Zm=e=>(e=>qm(e).filter((e=>e.rangeCount>0)).bind(Qm))(e).map((e=>Mm.exact(e.start,e.soffset,e.finish,e.foffset))),ed=(e,t)=>(e=>{const t=e.getClientRects(),o=t.length>0?t[0]:e.getBoundingClientRect();return o.width>0||o.height>0?Optional.some(o).map(xc):Optional.none()})(Dc(e,t)),td=(e,t,o)=>((e,t,o)=>{const n=he.fromDom(e.document);return Fm(n,t,o).map((e=>kc(he.fromDom(e.startContainer),e.startOffset,he.fromDom(e.endContainer),e.endOffset)))})(e,t,o),od=e=>({elementFromPoint:(t,o)=>he.fromPoint(he.fromDom(e.document),t,o),getRect:e=>e.dom.getBoundingClientRect(),getRangedRect:(t,o,n,r)=>{const l=Mm.exact(t,o,n,r);return ed(e,l)},getSelection:()=>Zm(e).map((t=>Nc(e,t))),fromSitus:t=>{const o=Mm.relative(t.start,t.finish);return Nc(e,o)},situsFromPoint:(t,o)=>td(e,t,o).map((e=>Ec(e.start,e.soffset,e.finish,e.foffset))),clearSelection:()=>{(e=>{qm(e).each((e=>e.removeAllRanges()))})(e)},collapseSelection:(t=!1)=>{Zm(e).each((o=>o.fold((e=>e.collapse(t)),((o,n)=>{const r=t?o:n;Ym(e,r,r)}),((o,n,r,l)=>{const s=t?o:r,a=t?n:l;Km(e,s,a,s,a)}))))},setSelection:t=>{Km(e,t.start,t.soffset,t.finish,t.foffset)},setRelativeSelection:(t,o)=>{Ym(e,t,o)},selectNode:t=>{Xm(e,t,!1)},selectContents:t=>{Xm(e,t)},getInnerHeight:()=>e.innerHeight,getScrollY:()=>(e=>{const t=void 0!==e?e.dom:document,o=t.body.scrollLeft||t.documentElement.scrollLeft,n=t.body.scrollTop||t.documentElement.scrollTop;return cn(o,n)})(he.fromDom(e.document)).top,scrollBy:(t,o)=>{((e,t,o)=>{const n=(void 0!==o?o.dom:document).defaultView;n&&n.scrollBy(e,t)})(t,o,he.fromDom(e.document))}}),nd=(e,t)=>({rows:e,cols:t}),rd=(e,t,o,n)=>{const r=((e,t,o,n)=>{const r=Dm(),l=r.clear,s=l=>{r.on((r=>{n.clearBeforeUpdate(t),km(l.target,o).each((s=>{Zr(r,s,o).each((o=>{const r=o.boxes.getOr([]);if(1===r.length){const o=r[0],s="false"===ts(o),a=ft(Zl(l.target),o,ve);s&&a&&(n.selectRange(t,r,o,o),e.selectContents(o))}else r.length>1&&(n.selectRange(t,r,o.start,o.finish),e.selectContents(s))}))}))}))};return{clearstate:l,mousedown:e=>{n.clear(t),km(e.target,o).each(r.set)},mouseover:e=>{s(e)},mouseup:e=>{s(e),l()}}})(od(e),t,o,n);return{clearstate:r.clearstate,mousedown:r.mousedown,mouseover:r.mouseover,mouseup:r.mouseup}},ld=(e,t,o,n)=>{const r=od(e),l=()=>(n.clear(t),Optional.none());return{keydown:(e,s,a,i,c,m)=>{const d=e.raw,u=d.which,p=!0===d.shiftKey,f=el(t,n.selectedSelector).fold((()=>(zm(u)&&!p&&n.clearBeforeUpdate(t),jm(u)&&p?b(Sm,r,t,o,Em,i,s,n.selectRange):Bm(u)&&p?b(Sm,r,t,o,Nm,i,s,n.selectRange):jm(u)?b(Cm,r,o,Em,i,s,Tm):Bm(u)?b(Cm,r,o,Nm,i,s,xm):Optional.none)),(e=>{const o=o=>()=>{const l=$(o,(o=>((e,t,o,n,r)=>ol(n,e,t,r.firstSelectedSelector,r.lastSelectedSelector).map((e=>(r.clearBeforeUpdate(o),r.selectRange(o,e.boxes,e.start,e.finish),e.boxes))))(o.rows,o.cols,t,e,n)));return l.fold((()=>tl(t,n.firstSelectedSelector,n.lastSelectedSelector).map((e=>{const o=jm(u)||m.isForward(u)?hc.after:hc.before;return r.setRelativeSelection(hc.on(e.first,0),o(e.table)),n.clear(t),bc(Optional.none(),!0)}))),(e=>Optional.some(bc(Optional.none(),!0))))};return jm(u)&&p?o([nd(1,0)]):Bm(u)&&p?o([nd(-1,0)]):m.isBackward(u)&&p?o([nd(0,-1),nd(-1,0)]):m.isForward(u)&&p?o([nd(0,1),nd(1,0)]):zm(u)&&!p?l:Optional.none}));return f()},keyup:(e,r,l,s,a)=>el(t,n.selectedSelector).fold((()=>{const i=e.raw,c=i.which;return!0===i.shiftKey&&zm(c)?((e,t,o,n,r,l,s)=>ve(o,r)&&n===l?Optional.none():pt(o,"td,th",t).bind((o=>pt(r,"td,th",t).bind((n=>Bc(e,t,o,n,s))))))(t,o,r,l,s,a,n.selectRange):Optional.none()}),Optional.none)}},sd=(e,t)=>{const o=de(e,t);return void 0===o||""===o?[]:o.split(" ")},ad=e=>void 0!==e.dom.classList,id=(e,t)=>((e,t,o)=>{const n=sd(e,t).concat([o]);return ce(e,t,n.join(" ")),!0})(e,"class",t),cd=(e,t)=>{ad(e)?e.dom.classList.add(t):id(e,t)},md=(e,t)=>ad(e)&&e.dom.classList.contains(t),dd=(e,t,o)=>{const n=t=>{pe(t,e.selected),pe(t,e.firstSelected),pe(t,e.lastSelected)},r=t=>{ce(t,e.selected,"1")},l=e=>{s(e),o()},s=t=>{const o=at(t,`${e.selectedSelector},${e.firstSelectedSelector},${e.lastSelectedSelector}`);E(o,n)};return{clearBeforeUpdate:s,clear:l,selectRange:(o,n,s,a)=>{l(o),E(n,r),ce(s,e.firstSelected,"1"),ce(a,e.lastSelected,"1"),t(n,s,a)},selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}},ud=()=>({tag:"none"}),pd=e=>({tag:"multiple",elements:e}),fd=e=>({tag:"single",element:e}),gd=(e,t,o)=>{const n=Jo.fromTable(e);return fs(n,t).map((e=>{const t=is(n,o,!1),{rows:r}=Ho(t),l=((e,t)=>{const o=e.slice(0,t[t.length-1].row+1),n=cs(o);return _(n,(e=>{const o=e.cells.slice(0,t[t.length-1].column+1);return k(o,(e=>e.element))}))})(r,e),s=((e,t)=>{const o=e.slice(t[0].row+t[0].rowspan-1,e.length),n=cs(o);return _(n,(e=>{const o=e.cells.slice(t[0].column+t[0].colspan-1,e.cells.length);return k(o,(e=>e.element))}))})(r,e);return{upOrLeftCells:l,downOrRightCells:s}}))},hd=e=>{const t=he.fromDom((e=>{if(Qe()&&m(e.target)){const t=he.fromDom(e.target);if(ne(t)&&tt(t)&&e.composed&&e.composedPath){const t=e.composedPath();if(t)return F(t)}}return Optional.from(e.target)})(e).getOr(e.target)),o=()=>e.stopPropagation(),n=()=>e.preventDefault(),r=(l=n,s=o,(...e)=>l(s.apply(null,e)));var l,s;return((e,t,o,n,r,l,s)=>({target:e,x:t,y:o,stop:n,prevent:r,kill:l,raw:s}))(t,e.clientX,e.clientY,o,n,r,e)},bd=(e,t,o,n,r)=>{const l=((e,t)=>o=>{e(o)&&t(hd(o))})(o,n);return e.dom.addEventListener(t,l,r),{unbind:b(wd,e,t,l,r)}},wd=(e,t,o,n)=>{e.dom.removeEventListener(t,o,n)},Od=y,vd=(e,t,o)=>((e,t,o,n)=>bd(e,t,o,n,!1))(e,t,Od,o),yd=hd,Cd=e=>!md(he.fromDom(e.target),"ephox-snooker-resizer-bar"),xd=(e,t)=>{const o=((e,t,o)=>({get:()=>nl(e(),o).fold((()=>t().fold(ud,fd)),pd)}))((()=>he.fromDom(e.getBody())),(()=>vl(Ar(e),Er(e))),hl.selectedSelector),n=dd(hl,((t,o,n)=>{$t(o).each((r=>{const l=di(e),s=Rr(p,he.fromDom(e.getDoc()),l),a=yl(e),i=gd(r,{selection:a},s);((e,t,o,n,r)=>{e.dispatch("TableSelectionChange",{cells:t,start:o,finish:n,otherCells:r})})(e,t,o,n,i)}))}),(()=>(e=>{e.dispatch("TableSelectionClear")})(e)));e.on("init",(o=>{const r=e.getWin(),l=kr(e),s=Er(e),a=rd(r,l,s,n),i=ld(r,l,s,n),c=((e,t,o,n)=>{const r=od(e);return(e,l)=>{n.clearBeforeUpdate(t),Zr(e,l,o).each((e=>{const o=e.boxes.getOr([]);n.selectRange(t,o,e.start,e.finish),r.selectContents(l),r.collapseSelection()}))}})(r,l,s,n);e.on("TableSelectorChange",(e=>c(e.start,e.finish)));const m=(t,o)=>{(e=>!0===e.raw.shiftKey)(t)&&(o.kill&&t.kill(),o.selection.each((t=>{const o=Mm.relative(t.start,t.finish),n=Dc(r,o);e.selection.setRng(n)})))},d=e=>0===e.button,u=(()=>{const e=Rm(he.fromDom(l)),t=Rm(0);return{touchEnd:o=>{const n=he.fromDom(o.target);if(ae("td")(n)||ae("th")(n)){const r=e.get(),l=t.get();ve(r,n)&&o.timeStamp-l<300&&(o.preventDefault(),c(n,n))}e.set(n),t.set(o.timeStamp)}}})();e.on("dragstart",(e=>{a.clearstate()})),e.on("mousedown",(e=>{d(e)&&Cd(e)&&a.mousedown(yd(e))})),e.on("mouseover",(e=>{var t;void 0!==(t=e).buttons&&0==(1&t.buttons)||!Cd(e)||a.mouseover(yd(e))})),e.on("mouseup",(e=>{d(e)&&Cd(e)&&a.mouseup(yd(e))})),e.on("touchend",u.touchEnd),e.on("keyup",(t=>{const o=yd(t);if(o.raw.shiftKey&&zm(o.raw.which)){const t=e.selection.getRng(),n=he.fromDom(t.startContainer),r=he.fromDom(t.endContainer);i.keyup(o,n,t.startOffset,r,t.endOffset).each((e=>{m(o,e)}))}})),e.on("keydown",(o=>{const n=yd(o);t.hide();const r=e.selection.getRng(),l=he.fromDom(r.startContainer),s=he.fromDom(r.endContainer),a=tn(Wm,Lm)(he.fromDom(e.selection.getStart()));i.keydown(n,l,r.startOffset,s,r.endOffset,a).each((e=>{m(n,e)})),t.show()})),e.on("NodeChange",(()=>{const t=e.selection,o=he.fromDom(t.getStart()),r=he.fromDom(t.getEnd());Qr($t,[o,r]).fold((()=>n.clear(l)),p)}))})),e.on("PreInit",(()=>{e.serializer.addTempAttr(hl.firstSelected),e.serializer.addTempAttr(hl.lastSelected)}));return{getSelectedCells:()=>((e,t,o,n)=>{switch(e.tag){case"none":return t();case"single":return n(e.element);case"multiple":return o(e.elements)}})(o.get(),f([]),(e=>k(e,(e=>e.dom))),(e=>[e.dom])),clearSelectedCells:e=>n.clear(he.fromDom(e))}},Td=e=>{let t=[];return{bind:e=>{if(void 0===e)throw new Error("Event bind error: undefined handler");t.push(e)},unbind:e=>{t=A(t,(t=>t!==e))},trigger:(...o)=>{const n={};E(e,((e,t)=>{n[e]=o[t]})),E(t,(e=>{e(n)}))}}},Sd=e=>({registry:G(e,(e=>({bind:e.bind,unbind:e.unbind}))),trigger:G(e,(e=>e.trigger))}),Rd=e=>e.slice(0).sort(),Dd=(e,t,o)=>{if(0===t.length)throw new Error("You must specify at least one required field.");return((e,t)=>{if(!s(t))throw new Error("The "+e+" fields must be an array. Was: "+t+".");E(t,(t=>{if(!r(t))throw new Error("The value "+t+" in the "+e+" fields was not a string.")}))})("required",t),(e=>{const t=Rd(e);z(t,((e,o)=>o<t.length-1&&e===t[o+1])).each((e=>{throw new Error("The field: "+e+" occurs more than once in the combined fields: ["+t.join(", ")+"].")}))})(t),n=>{const r=q(n);M(t,(e=>S(r,e)))||((e,t)=>{throw new Error("All required keys ("+Rd(e).join(", ")+") were not specified. Specified keys were: "+Rd(t).join(", ")+".")})(t,r),e(t,r);const l=A(t,(e=>!o.validate(n[e],e)));return l.length>0&&((e,t)=>{throw new Error("All values need to be of type: "+t+". Keys ("+Rd(e).join(", ")+") were not.")})(l,o.label),n}},kd=(e,t)=>{const o=A(t,(t=>!S(e,t)));o.length>0&&(e=>{throw new Error("Unsupported keys for object: "+Rd(e).join(", "))})(o)},Ed=e=>((e,t)=>Dd(e,t,{validate:d,label:"function"}))(kd,e),Nd=Ed(["compare","extract","mutate","sink"]),Ad=Ed(["element","start","stop","destroy"]),Bd=Ed(["forceDrop","drop","move","delayDrop"]),jd=()=>{let e=Optional.none();const t=Sd({move:Td(["info"])});return{onEvent:(o,n)=>{n.extract(o).each((o=>{const r=((t,o)=>{const n=e.map((e=>t.compare(e,o)));return e=Optional.some(o),n})(n,o);r.each((e=>{t.trigger.move(e)}))}))},reset:()=>{e=Optional.none()},events:t.registry}},zd=()=>{const e=(()=>{const e=Sd({move:Td(["info"])});return{onEvent:p,reset:p,events:e.registry}})(),t=jd();let o=e;return{on:()=>{o.reset(),o=t},off:()=>{o.reset(),o=e},isOn:()=>o===t,onEvent:(e,t)=>{o.onEvent(e,t)},events:t.events}},Wd=(e,t,o)=>{let n=!1;const r=Sd({start:Td([]),stop:Td([])}),l=zd(),s=()=>{m.stop(),l.isOn()&&(l.off(),r.trigger.stop())},i=((e,t)=>{let o=null;const n=()=>{a(o)||(clearTimeout(o),o=null)};return{cancel:n,throttle:(...r)=>{n(),o=setTimeout((()=>{o=null,e.apply(null,r)}),t)}}})(s,200);l.events.move.bind((o=>{t.mutate(e,o.info)}));const c=e=>(...t)=>{n&&e.apply(null,t)},m=t.sink(Bd({forceDrop:s,drop:c(s),move:c((e=>{i.cancel(),l.onEvent(e,t)})),delayDrop:c(i.throttle)}),o);return{element:m.element,go:e=>{m.start(e),l.on(),r.trigger.start()},on:()=>{n=!0},off:()=>{n=!1},destroy:()=>{m.destroy()},events:r.registry}},Ld=e=>{const t=e.replace(/\./g,"-");return{resolve:e=>t+"-"+e}},_d=Ld("ephox-dragster").resolve;var Md=Nd({compare:(e,t)=>cn(t.left-e.left,t.top-e.top),extract:e=>Optional.some(cn(e.x,e.y)),sink:(e,t)=>{const o=(e=>{const t={layerClass:_d("blocker"),...e},o=he.fromTag("div");return ce(o,"role","presentation"),Rt(o,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),cd(o,_d("blocker")),cd(o,t.layerClass),{element:f(o),destroy:()=>{Ie(o)}}})(t),n=vd(o.element(),"mousedown",e.forceDrop),r=vd(o.element(),"mouseup",e.drop),l=vd(o.element(),"mousemove",e.move),s=vd(o.element(),"mouseout",e.delayDrop);return Ad({element:o.element,start:e=>{ze(e,o.element())},stop:()=>{Ie(o.element())},destroy:()=>{o.destroy(),r.unbind(),l.unbind(),s.unbind(),n.unbind()}})},mutate:(e,t)=>{e.mutate(t.left,t.top)}});const Id=Ld("ephox-snooker").resolve,Pd=()=>{const e=Sd({drag:Td(["xDelta","yDelta","target"])});let t=Optional.none();const o=(()=>{const e=Sd({drag:Td(["xDelta","yDelta"])});return{mutate:(t,o)=>{e.trigger.drag(t,o)},events:e.registry}})();o.events.drag.bind((o=>{t.each((t=>{e.trigger.drag(o.xDelta,o.yDelta,t)}))}));return{assign:e=>{t=Optional.some(e)},get:()=>t,mutate:o.mutate,events:e.registry}},Fd=Id("resizer-bar"),Hd=Id("resizer-rows"),$d=Id("resizer-cols"),qd=e=>{const t=at(e.parent(),"."+Fd);E(t,Ie)},Vd=(e,t,o)=>{const n=e.origin();E(t,(t=>{t.each((t=>{const r=o(n,t);cd(r,Fd),ze(e.parent(),r)}))}))},Ud=(e,t,o,n)=>{Vd(e,t,((e,t)=>{const r=((e,t,o,n,r)=>{const l=he.fromTag("div");return Rt(l,{position:"absolute",left:t-n/2+"px",top:o+"px",height:r+"px",width:n+"px"}),me(l,{"data-column":e,role:"presentation"}),l})(t.col,t.x-e.left,o.top-e.top,7,n);return cd(r,$d),r}))},Gd=(e,t,o,n)=>{Vd(e,t,((e,t)=>{const r=((e,t,o,n,r)=>{const l=he.fromTag("div");return Rt(l,{position:"absolute",left:t+"px",top:o-r/2+"px",height:r+"px",width:n+"px"}),me(l,{"data-row":e,role:"presentation"}),l})(t.row,o.left-e.left,t.y-e.top,n,7);return cd(r,Hd),r}))},Kd=(e,t,o,n,r)=>{const l=dn(o),s=t.isResizable,a=n.length>0?xn.positions(n,o):[],i=a.length>0?((e,t)=>_(e.all,((e,o)=>t(e.element)?[o]:[])))(e,s):[],c=A(a,((e,t)=>R(i,(e=>t===e))));Gd(t,c,l,Bo(o));const m=r.length>0?Sn.positions(r,o):[],d=m.length>0?((e,t)=>{const o=[];return D(e.grid.columns,(n=>{const r=Jo.getColumnAt(e,n).map((e=>e.element));r.forall(t)&&o.push(n)})),A(o,(o=>{const n=Jo.filterItems(e,(e=>e.column===o));return M(n,(e=>t(e.element)))}))})(e,s):[],u=A(m,((e,t)=>R(d,(e=>t===e))));Ud(t,u,l,ln(o))},Yd=(e,t)=>{if(qd(e),e.isResizable(t)){const o=Jo.fromTable(t),n=Zo(o),r=Qo(o);Kd(o,e,t,n,r)}},Jd=(e,t)=>{const o=at(e.parent(),"."+Fd);E(o,t)},Qd=e=>{Jd(e,(e=>{St(e,"display","none")}))},Xd=e=>{Jd(e,(e=>{St(e,"display","block")}))},Zd=Id("resizer-bar-dragging"),eu=e=>{const t=Pd(),o=((e,t={})=>{var o;const n=null!==(o=t.mode)&&void 0!==o?o:Md;return Wd(e,n,t)})(t,{});let n=Optional.none();const r=(e,t)=>Optional.from(de(e,t));t.events.drag.bind((e=>{r(e.target,"data-row").each((t=>{const o=Wt(e.target,"top");St(e.target,"top",o+e.yDelta+"px")})),r(e.target,"data-column").each((t=>{const o=Wt(e.target,"left");St(e.target,"left",o+e.xDelta+"px")}))}));const l=(e,t)=>Wt(e,t)-At(e,"data-initial-"+t,0);o.events.stop.bind((()=>{t.get().each((t=>{n.each((o=>{r(t,"data-row").each((e=>{const n=l(t,"top");pe(t,"data-initial-top"),m.trigger.adjustHeight(o,n,parseInt(e,10))})),r(t,"data-column").each((e=>{const n=l(t,"left");pe(t,"data-initial-left"),m.trigger.adjustWidth(o,n,parseInt(e,10))})),Yd(e,o)}))}))}));const s=(n,r)=>{m.trigger.startAdjust(),t.assign(n),ce(n,"data-initial-"+r,Wt(n,r)),cd(n,Zd),St(n,"opacity","0.2"),o.go(e.parent())},a=vd(e.parent(),"mousedown",(e=>{var t;t=e.target,md(t,Hd)&&s(e.target,"top"),(e=>md(e,$d))(e.target)&&s(e.target,"left")})),i=t=>ve(t,e.view()),c=vd(e.view(),"mouseover",(t=>{var o;(o=t.target,pt(o,"table",i).filter(es)).fold((()=>{ot(t.target)&&qd(e)}),(t=>{n=Optional.some(t),Yd(e,t)}))})),m=Sd({adjustHeight:Td(["table","delta","row"]),adjustWidth:Td(["table","delta","column"]),startAdjust:Td([])});return{destroy:()=>{a.unbind(),c.unbind(),o.destroy(),qd(e)},refresh:t=>{Yd(e,t)},on:o.on,off:o.off,hideBars:b(Qd,e),showBars:b(Xd,e),events:m.registry}},tu=(e,t,o)=>{const n=xn,r=Sn,l=eu(e),s=Sd({beforeResize:Td(["table","type"]),afterResize:Td(["table","type"]),startDrag:Td([])});return l.events.adjustHeight.bind((e=>{const t=e.table;s.trigger.beforeResize(t,"row");const o=n.delta(e.delta,t);Qs(t,o,e.row,n),s.trigger.afterResize(t,"row")})),l.events.startAdjust.bind((e=>{s.trigger.startDrag()})),l.events.adjustWidth.bind((e=>{const n=e.table;s.trigger.beforeResize(n,"col");const l=r.delta(e.delta,n),a=o(n);Js(n,l,e.column,t,a),s.trigger.afterResize(n,"col")})),{on:l.on,off:l.off,refreshBars:l.refresh,hideBars:l.hideBars,showBars:l.showBars,destroy:l.destroy,events:s.registry}},ou=(e,t)=>{const o=le(e)?(e=>he.fromDom(Te(e).dom.documentElement))(e):e;return{parent:f(o),view:f(e),origin:f(cn(0,0)),isResizable:t}},nu=(e,t,o)=>({parent:f(t),view:f(e),origin:f(cn(0,0)),isResizable:o}),ru=()=>{const e=he.fromTag("div");return Rt(e,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),ze(nt(he.fromDom(document)),e),e},lu=e=>m(e)&&"TABLE"===e.nodeName,su="bar-",au=e=>"false"!==de(e,"data-mce-resize"),iu=e=>{const t=Dm(),o=Dm(),n=Dm();let r,l;const s=t=>Si(e,t),a=()=>fi(e)?Ll():Wl(),i=(t,o,n)=>{const i=vt(o,"e");if(""===l&&Ui(t),n!==r&&""!==l){St(t,"width",l);const o=a(),c=s(t),m=fi(e)||i?(e=>_l(e).columns)(t)-1:0;Js(t,n-r,m,o,c)}else if((e=>/^(\d+(\.\d+)?)%$/.test(e))(l)){const e=parseFloat(l.replace("%",""));St(t,"width",n*e/r+"%")}(e=>/^(\d+(\.\d+)?)px$/.test(e))(l)&&(e=>{const t=Jo.fromTable(e);Jo.hasColumns(t)||E(Ft(e),(e=>{const t=Dt(e,"width");St(e,"width",t),pe(e,"width")}))})(t)},c=()=>{o.on((e=>{e.destroy()})),n.on((t=>{((e,t)=>{e.inline&&Ie(t.parent())})(e,t)}))};e.on("init",(()=>{const r=((e,t)=>e.inline?nu(he.fromDom(e.getBody()),ru(),t):ou(he.fromDom(e.getDoc()),t))(e,au);if(n.set(r),(e=>{const t=e.options.get("object_resizing");return S(t.split(","),"table")})(e)&&vi(e)){const n=a(),l=tu(r,n,s);l.on(),l.events.startDrag.bind((o=>{t.set(e.selection.getRng())})),l.events.beforeResize.bind((t=>{const o=t.table.dom;((e,t,o,n,r)=>{e.dispatch("ObjectResizeStart",{target:t,width:o,height:n,origin:r})})(e,o,Br(o),jr(o),su+t.type)})),l.events.afterResize.bind((o=>{const n=o.table,r=n.dom;Nr(n),t.on((t=>{e.selection.setRng(t),e.focus()})),((e,t,o,n,r)=>{e.dispatch("ObjectResized",{target:t,width:o,height:n,origin:r})})(e,r,Br(r),jr(r),su+o.type),e.undoManager.add()})),o.set(l)}})),e.on("ObjectResizeStart",(t=>{const o=t.target;if(lu(o)){const n=he.fromDom(o);E(e.dom.select(".mce-clonedresizable"),(t=>{e.dom.addClass(t,"mce-"+pi(e)+"-columns")})),!$i(n)&&wi(e)?Gi(n):!Hi(n)&&bi(e)&&Ui(n),qi(n)&&Ot(t.origin,su)&&Ui(n),r=t.width,l=Oi(e)?"":((e,t)=>{const o=e.dom.getStyle(t,"width")||e.dom.getAttrib(t,"width");return Optional.from(o).filter(Ct)})(e,o).getOr("")}})),e.on("ObjectResized",(t=>{const o=t.target;if(lu(o)){const n=he.fromDom(o),r=t.origin;Ot(r,"corner-")&&i(n,r,t.width),Nr(n),ri(e,n.dom,li)}})),e.on("SwitchMode",(()=>{o.on((t=>{e.mode.isReadOnly()?t.hideBars():t.showBars()}))})),e.on("remove",(()=>{c()}));return{refresh:e=>{o.on((t=>t.refreshBars(he.fromDom(e))))},hide:()=>{o.on((e=>e.hideBars()))},show:()=>{o.on((e=>e.showBars()))}}},cu=e=>{(e=>{const t=e.options.register;t("table_clone_elements",{processor:"string[]"}),t("table_use_colgroups",{processor:"boolean",default:!0}),t("table_header_type",{processor:e=>{const t=S(["section","cells","sectionCells","auto"],e);return t?{value:e,valid:t}:{valid:!1,message:"Must be one of: section, cells, sectionCells or auto."}},default:"section"}),t("table_sizing_mode",{processor:"string",default:"auto"}),t("table_default_attributes",{processor:"object",default:{border:"1"}}),t("table_default_styles",{processor:"object",default:{"border-collapse":"collapse"}}),t("table_column_resizing",{processor:e=>{const t=S(["preservetable","resizetable"],e);return t?{value:e,valid:t}:{valid:!1,message:"Must be preservetable, or resizetable."}},default:"preservetable"}),t("table_resize_bars",{processor:"boolean",default:!0}),t("table_style_by_css",{processor:"boolean",default:!0})})(e);const t=iu(e),o=xd(e,t),n=Ri(e,t,o);return fc(e,n),((e,t)=>{const o=Er(e),n=t=>vl(Ar(e)).bind((n=>$t(n,o).map((o=>{const r=bl(yl(e),o,n);return t(o,r)})))).getOr("");U({mceTableRowType:()=>n(t.getTableRowType),mceTableCellType:()=>n(t.getTableCellType),mceTableColType:()=>n(t.getTableColType)},((t,o)=>e.addQueryValueHandler(o,t)))})(e,n),Cl(e,n),{getSelectedCells:o.getSelectedCells,clearSelectedCells:o.clearSelectedCells}},mu=e=>({table:cu(e)});e.add("dom",mu)}();